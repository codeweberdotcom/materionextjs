# –ü–æ–¥—Ä–æ–±–Ω—ã–π –ø–ª–∞–Ω —É–ª—É—á—à–µ–Ω–∏–π –¥–ª—è –î–æ—Å–∫–∏ –æ–±—ä—è–≤–ª–µ–Ω–∏–π
## –ê–Ω–∞–ª–∏–∑ –º–æ–¥—É–ª–µ–π RateLimit –∏ Block

**–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è:** 2025-11-16  
**–í–µ—Ä—Å–∏—è:** 1.0  
**–°—Ç–∞—Ç—É—Å:** –î–ª—è –æ–±—Å—É–∂–¥–µ–Ω–∏—è –∫–æ–º–∞–Ω–¥–æ–π

---

## üìã Executive Summary

–ü—Ä–æ–µ–∫—Ç "–î–æ—Å–∫–∞ –æ–±—ä—è–≤–ª–µ–Ω–∏–π" –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π —Å–æ–≤—Ä–µ–º–µ–Ω–Ω–æ–µ –≤–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Å —Ä–∞–∑–≤–∏—Ç–æ–π —Å–∏—Å—Ç–µ–º–æ–π –∑–∞—â–∏—Ç—ã –æ—Ç —Å–ø–∞–º–∞ –∏ –∑–ª–æ—É–ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏–π. –ú–æ–¥—É–ª–∏ `rate-limit` –∏ `block` —è–≤–ª—è—é—Ç—Å—è –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–Ω—ã–º–∏ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞–º–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏. –ê–Ω–∞–ª–∏–∑ –≤—ã—è–≤–∏–ª —Å–∏–ª—å–Ω—É—é –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—É—é –æ—Å–Ω–æ–≤—É —Å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—è–º–∏ –¥–ª—è –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω—ã—Ö —É–ª—É—á—à–µ–Ω–∏–π –≤ –æ–±–ª–∞—Å—Ç—è—Ö –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏, –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –∏ —É–¥–æ–±—Å—Ç–≤–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è.

### üéØ –ö–ª—é—á–µ–≤—ã–µ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è
- ‚úÖ Resilient –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–º fallback (Redis ‚Üí Prisma)
- ‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∫–∞ PII-–º–∏–Ω–∏–º–∏–∑–∞—Ü–∏–∏ (—Ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ IP –∏ email)
- ‚úÖ –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –º–µ—Ç—Ä–∏–∫–∏ (Prometheus/Grafana)
- ‚úÖ –î–µ–¥—É–ø–ª–∏–∫–∞—Ü–∏—è —Å–æ–±—ã—Ç–∏–π –≤ Redis store
- ‚úÖ –ê–¥–º–∏–Ω—Å–∫–∏–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –±–ª–æ–∫–∞–º–∏

### ‚ö†Ô∏è –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –æ–±–ª–∞—Å—Ç–∏ –¥–ª—è —É–ª—É—á—à–µ–Ω–∏—è
1. **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö** - –ø–æ–ª–Ω–∞—è GDPR-—Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å
2. **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å** - –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –∑–∞–ø—Ä–æ—Å–æ–≤ –∏ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è
3. **–¢–∏–ø–∏–∑–∞—Ü–∏—è** - —É—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ `any` –∏ —É–ª—É—á—à–µ–Ω–∏–µ TypeScript —Å—Ç—Ä–æ–≥–æ—Å—Ç–∏
4. **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ** - –ø–æ–∫—Ä—ã—Ç–∏–µ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
5. **–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è** - –æ–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –¥–ª—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤

---

## üîí –ü–ª–∞–Ω —É–ª—É—á—à–µ–Ω–∏—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

### 1. PII-–º–∏–Ω–∏–º–∏–∑–∞—Ü–∏—è –∏ GDPR-—Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å

#### 1.1 –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –∑–∞–¥–∞—á–∏ (1-2 –Ω–µ–¥–µ–ª–∏)

**–ó–∞–¥–∞—á–∞ 1.1.1: –ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ PII-—Ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏—è**
- **–°—Ç–∞—Ç—É—Å:** –ß–∞—Å—Ç–∏—á–Ω–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –ó–∞–≤–µ—Ä—à–∏—Ç—å –ø–µ—Ä–µ—Ö–æ–¥ –Ω–∞ —Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ç–æ–ª—å–∫–æ —Ö–µ—à–µ–π IP –∏ email
- **–§–∞–π–ª—ã:** `src/lib/rate-limit.ts` (—Å—Ç—Ä–æ–∫–∏ 380-505)
- **–î–µ–π—Å—Ç–≤–∏—è:**
  - –î–æ–±–∞–≤–∏—Ç—å –ø–æ–ª—è `ipHash`, `ipPrefix`, `emailHash` –≤ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ —Ç–∞–±–ª–∏—Ü—ã
  - –û–±–Ω–æ–≤–∏—Ç—å –ª–æ–≥–∏–∫—É `recordEvent()` –¥–ª—è –∑–∞–ø–∏—Å–∏ —Ç–æ–ª—å–∫–æ —Ö–µ—à–µ–π
  - –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —Ä–µ—Ç–µ–Ω—à–Ω-–ø—Ä–æ—Ü–µ–¥—É—Ä—ã –¥–ª—è –æ—á–∏—Å—Ç–∫–∏ —Å—ã—Ä—ã—Ö –¥–∞–Ω–Ω—ã—Ö
  - –î–æ–±–∞–≤–∏—Ç—å —Ä–æ—Ç–∞—Ü–∏—é —Å–µ–∫—Ä–µ—Ç–æ–≤ —Å –≤–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ–º —Ö–µ—à–µ–π

**–ó–∞–¥–∞—á–∞ 1.1.2: –ü–æ–ª–∏—Ç–∏–∫–∏ —Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö**
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –°–æ–∑–¥–∞—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç —Å –ø–æ–ª–∏—Ç–∏–∫–∞–º–∏ —Ö—Ä–∞–Ω–µ–Ω–∏—è PII
- **–°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ:**
  - –í—Ä–µ–º—è —Ö—Ä–∞–Ω–µ–Ω–∏—è —Å–æ–±—ã—Ç–∏–π rate-limit (—Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è: 90 –¥–Ω–µ–π)
  - –í—Ä–µ–º—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –±–ª–æ–∫–æ–≤ (—Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è: 1 –≥–æ–¥)
  - –ü—Ä–æ—Ü–µ–¥—É—Ä—ã –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –æ—á–∏—Å—Ç–∫–∏
  - –ü—Ä–∞–≤–∞ —Å—É–±—ä–µ–∫—Ç–æ–≤ –¥–∞–Ω–Ω—ã—Ö (–∑–∞–±—ã—Ç—å, –ø–æ–ª—É—á–∏—Ç—å –∫–æ–ø–∏—é)

**–ó–∞–¥–∞—á–∞ 1.1.3: –ú–∞—Å–∫–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ –ª–æ–≥–∞—Ö**
- **–§–∞–π–ª—ã:** `src/lib/logger/index.ts`
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –û–±–Ω–æ–≤–∏—Ç—å –ª–æ–≥–≥–µ—Ä –¥–ª—è –º–∞—Å–∫–∏—Ä–æ–≤–∞–Ω–∏—è —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- **–î–µ–π—Å—Ç–≤–∏—è:**
  - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –º–∞—Å–∫–∏—Ä–æ–≤–∞–Ω–∏–µ IP-–∞–¥—Ä–µ—Å–æ–≤: `192.168.1.xxx`
  - –ú–∞—Å–∫–∏—Ä–æ–≤–∞–Ω–∏–µ email: `user***@example.com`
  - –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –≤ Sentry (—É–∂–µ —á–∞—Å—Ç–∏—á–Ω–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ)

#### 1.2 –£–ª—É—á—à–µ–Ω–∏—è —Å—Ä–µ–¥–Ω–µ–≥–æ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–∞ (2-4 –Ω–µ–¥–µ–ª–∏)

**–ó–∞–¥–∞—á–∞ 1.2.1: –®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ –¥–æ–ª–≥–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –±–ª–æ–∫–æ–≤**
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –î–ª—è permanent –±–ª–æ–∫–æ–≤ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ –≤–º–µ—Å—Ç–æ —Ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏—è
- **–¢–µ—Ö–Ω–æ–ª–æ–≥–∏—è:** AES-256-GCM —Å –∞–ø–ø–∞—Ä–∞—Ç–Ω—ã–º –∫–ª—é—á–æ–º
- **–°—Ü–µ–Ω–∞—Ä–∏–∏:** –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∏ –ø–æ —Ä–µ—à–µ–Ω–∏—é —Å—É–¥–∞,Ê∞∏‰πÖ–Ω—ã–µ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ –º–æ—à–µ–Ω–Ω–∏–∫–æ–≤

**–ó–∞–¥–∞—á–∞ 1.2.2: –ê—É–¥–∏—Ç –¥–æ—Å—Ç—É–ø–∞ –∫ –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–º –¥–∞–Ω–Ω—ã–º**
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –æ–±—Ä–∞—â–µ–Ω–∏–π –∫ PII
- **–ü–æ–ª—è:** IP-–∞–¥—Ä–µ—Å –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞, –∑–∞–ø—Ä–∞—à–∏–≤–∞–µ–º—ã–µ –¥–∞–Ω–Ω—ã–µ, –≤—Ä–µ–º—è –¥–æ—Å—Ç—É–ø–∞

**–ó–∞–¥–∞—á–∞ 1.2.3: –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å —Å–∏—Å—Ç–µ–º–∞–º–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å–æ–≥–ª–∞—Å–∏–µ–º**
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∏ –ø—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ–≥–ª–∞—Å–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- **–•—Ä–∞–Ω–µ–Ω–∏–µ:** –û—Ç–¥–µ–ª—å–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞ `UserConsent`

### 2. –£—Å–∏–ª–µ–Ω–∏–µ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏

#### 2.1 –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –∑–∞–¥–∞—á–∏ (1 –Ω–µ–¥–µ–ª—è)

**–ó–∞–¥–∞—á–∞ 2.1.1: MFA –¥–ª—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤**
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –î–æ–±–∞–≤–∏—Ç—å –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—É—é –¥–≤—É—Ö—Ñ–∞–∫—Ç–æ—Ä–Ω—É—é –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—é
- **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è:** TOTP (Time-based One-Time Password)
- **–°—Ç—Ä–∞–Ω–∏—Ü—ã:** `/admin/login`

**–ó–∞–¥–∞—á–∞ 2.1.2: Session hardening**
- **–§–∞–π–ª—ã:** `src/app/api/auth/session/route.ts`
- **–£–ª—É—á—à–µ–Ω–∏—è:**
  - HttpOnly + Secure cookies
  - SameSite=strict
  - Rotation –ø—Ä–∏ –∫–∞–∂–¥–æ–º –∑–∞–ø—Ä–æ—Å–µ
  - –ü—Ä–∏–≤—è–∑–∫–∞ –∫ IP –∏ User-Agent

**–ó–∞–¥–∞—á–∞ 2.1.3: CSRF –∑–∞—â–∏—Ç–∞**
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –î–æ–±–∞–≤–∏—Ç—å CSRF —Ç–æ–∫–µ–Ω—ã –¥–ª—è –≤—Å–µ—Ö —Ñ–æ—Ä–º
- **–¢–µ—Ö–Ω–æ–ª–æ–≥–∏—è:** Double Submit Cookie pattern
- **Coverage:** –í—Å–µ POST/PUT/PATCH/DELETE –∑–∞–ø—Ä–æ—Å—ã

#### 2.2 –°—Ä–µ–¥–Ω–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç (2 –Ω–µ–¥–µ–ª–∏)

**–ó–∞–¥–∞—á–∞ 2.2.1: Step-up –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è**
- **–°—Ü–µ–Ω–∞—Ä–∏–∏:** –ü—Ä–æ—Å–º–æ—Ç—Ä PII, –º–∞—Å—Å–æ–≤—ã–µ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏, —ç–∫—Å–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö
- **–¢—Ä–∏–≥–≥–µ—Ä—ã:** –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–ø–∏—Å–µ–π > 100, –¥–æ—Å—Ç—É–ø –∫ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–º –¥–∞–Ω–Ω—ã–º

**–ó–∞–¥–∞—á–∞ 2.2.2: –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –≤–Ω–µ—à–Ω–∏–º–∏ —Å–∏—Å—Ç–µ–º–∞–º–∏ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏**
- **–ü–æ–¥–¥–µ—Ä–∂–∫–∞:** SAML 2.0, OAuth 2.0, LDAP
- **–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** –î–ª—è –∫–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω—ã—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤

### 3. –ó–∞—â–∏—Ç–∞ –æ—Ç –∞—Ç–∞–∫

#### 3.1 –í—ã—Å–æ–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç (1 –Ω–µ–¥–µ–ª—è)

**–ó–∞–¥–∞—á–∞ 3.1.1: Content Security Policy (CSP)**
- **–§–∞–π–ª—ã:** `src/middleware.ts`
- **–ü–æ–ª–∏—Ç–∏–∫–∞:** –°—Ç—Ä–æ–≥–∏–π CSP —Å nonce –¥–ª—è —Å–∫—Ä–∏–ø—Ç–æ–≤
- **–ó–∞–≥–æ–ª–æ–≤–∫–∏:** HSTS, X-Frame-Options, X-Content-Type-Options

**–ó–∞–¥–∞—á–∞ 3.1.2: Rate limiting –¥–ª—è API –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏**
- **–õ–∏–º–∏—Ç—ã:** 
  - Login: 5 –ø–æ–ø—ã—Ç–æ–∫/15 –º–∏–Ω—É—Ç
  - Password reset: 3 –ø–æ–ø—ã—Ç–∫–∏/—á–∞—Å
  - Registration: 3 –ø–æ–ø—ã—Ç–∫–∏/—á–∞—Å
- **–ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞:** IP + email hash

**–ó–∞–¥–∞—á–∞ 3.1.3: –ó–∞—â–∏—Ç–∞ –æ—Ç –±—Ä—É—Ç—Ñ–æ—Ä—Å–∞**
- **–ê–ª–≥–æ—Ä–∏—Ç–º:** –≠–∫—Å–ø–æ–Ω–µ–Ω—Ü–∏–∞–ª—å–Ω–∞—è –∑–∞–¥–µ—Ä–∂–∫–∞
- **–•—Ä–∞–Ω–µ–Ω–∏–µ:** Redis –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞
- **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥:** –ê–ª–µ—Ä—Ç—ã –ø—Ä–∏ –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω–æ–π –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏

#### 3.2 –°—Ä–µ–¥–Ω–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç (2 –Ω–µ–¥–µ–ª–∏)

**–ó–∞–¥–∞—á–∞ 3.2.1: DDoS –∑–∞—â–∏—Ç–∞**
- **Layer 7:** Rate limiting + challenge/response
- **Layer 3/4:** –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å CloudFlare/AWS Shield
- **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥:** –ê–Ω–æ–º–∞–ª—å–Ω—ã–π —Ç—Ä–∞—Ñ–∏–∫ –ø–æ –ø–∞—Ç—Ç–µ—Ä–Ω–∞–º

**–ó–∞–¥–∞—á–∞ 3.2.2: –ó–∞—â–∏—Ç–∞ –æ—Ç –∏–Ω—ä–µ–∫—Ü–∏–π**
- **SQL:** Prepared statements (—É–∂–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ —á–µ—Ä–µ–∑ Prisma)
- **NoSQL:** –í–∞–ª–∏–¥–∞—Ü–∏—è –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- **XSS:** Content Security Policy + —ç–∫—Ä–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ

---

## üèóÔ∏è –ü–ª–∞–Ω —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–∞ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã

### 1. –£–ª—É—á—à–µ–Ω–∏–µ –º–æ–¥—É–ª—å–Ω–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä—ã

#### 1.1 –ü–µ—Ä–µ—Ö–æ–¥ –∫ Feature-First –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–µ (4-6 –Ω–µ–¥–µ–ª—å)

**–¢–µ–∫—É—â–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞:**
```
src/
‚îú‚îÄ‚îÄ lib/           # –°–º–µ—à–∞–Ω–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å
‚îú‚îÄ‚îÄ components/    # UI –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
‚îú‚îÄ‚îÄ hooks/         # React hooks
‚îî‚îÄ‚îÄ app/           # Next.js routes
```

**–¶–µ–ª–µ–≤–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞:**
```
src/
‚îú‚îÄ‚îÄ modules/
‚îÇ   ‚îú‚îÄ‚îÄ rate-limit/        # –ú–æ–¥—É–ª—å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è —á–∞—Å—Ç–æ—Ç—ã
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ domain/        # –ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ application/   # Use cases
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ infrastructure/# Redis, Prisma, API
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ ui/           # React –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
‚îÇ   ‚îú‚îÄ‚îÄ user-management/   # –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏
‚îÇ   ‚îú‚îÄ‚îÄ notifications/     # –°–∏—Å—Ç–µ–º–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
‚îÇ   ‚îî‚îÄ‚îÄ audit/            # –ê—É–¥–∏—Ç –¥–µ–π—Å—Ç–≤–∏–π
‚îú‚îÄ‚îÄ shared/
‚îÇ   ‚îú‚îÄ‚îÄ domain/           # –û–±—â–∏–µ –¥–æ–º–µ–Ω–Ω—ã–µ –º–æ–¥–µ–ª–∏
‚îÇ   ‚îú‚îÄ‚îÄ ui/               # UI kit
‚îÇ   ‚îú‚îÄ‚îÄ infrastructure/   # –û–±—â–∞—è –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞
‚îÇ   ‚îî‚îÄ‚îÄ utils/            # –£—Ç–∏–ª–∏—Ç—ã
‚îî‚îÄ‚îÄ app/                  # Next.js pages (thin layer)
```

#### 1.2 –í–Ω–µ–¥—Ä–µ–Ω–∏–µ Clean Architecture (8-10 –Ω–µ–¥–µ–ª—å)

**–ó–∞–¥–∞—á–∞ 1.2.1: –î–æ–º–µ–Ω–Ω—ã–µ –º–æ–¥–µ–ª–∏**
- **–§–∞–π–ª—ã:** `src/modules/rate-limit/domain/`
- **–°–æ–∑–¥–∞—Ç—å:**
  - `RateLimitRule.ts` - –±–∏–∑–Ω–µ—Å-–ø—Ä–∞–≤–∏–ª–∞
  - `BlockPolicy.ts` - –ø–æ–ª–∏—Ç–∏–∫–∏ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏
  - `ViolationEvent.ts` - —Å–æ–±—ã—Ç–∏—è –Ω–∞—Ä—É—à–µ–Ω–∏–π

**–ó–∞–¥–∞—á–∞ 1.2.2: Application —Å–ª–æ–π**
- **–§–∞–π–ª—ã:** `src/modules/rate-limit/application/`
- **–°–æ–∑–¥–∞—Ç—å:**
  - `CreateRateLimitUseCase.ts`
  - `CheckRateLimitUseCase.ts`
  - `ManageBlocksUseCase.ts`
  - `GetStatisticsUseCase.ts`

**–ó–∞–¥–∞—á–∞ 1.2.3: Infrastructure –∞–¥–∞–ø—Ç–µ—Ä—ã**
- **–§–∞–π–ª—ã:** `src/modules/rate-limit/infrastructure/`
- **–°–æ–∑–¥–∞—Ç—å:**
  - `PrismaRateLimitRepository.ts`
  - `RedisRateLimitRepository.ts`
  - `RateLimitConfigurationService.ts`

### 2. –£–ª—É—á—à–µ–Ω–∏–µ API –¥–∏–∑–∞–π–Ω–∞

#### 2.1 –í—ã—Å–æ–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç (2 –Ω–µ–¥–µ–ª–∏)

**–ó–∞–¥–∞—á–∞ 2.1.1: –í–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ API**
- **–§–æ—Ä–º–∞—Ç:** `/api/v1/rate-limits/`
- **–û–±—Ä–∞—Ç–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å:** –ü–æ–¥–¥–µ—Ä–∂–∫–∞ v1 –≤ —Ç–µ—á–µ–Ω–∏–µ 6 –º–µ—Å—è—Ü–µ–≤
- **–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è:** OpenAPI 3.0 —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏–∏

**–ó–∞–¥–∞—á–∞ 2.1.2: –°—Ç–∞–Ω–¥–∞—Ä—Ç–∏–∑–∞—Ü–∏—è –æ—Ç–≤–µ—Ç–æ–≤**
- **–§–æ—Ä–º–∞—Ç:** RFC 7807 Problem Details
- **–ü—Ä–∏–º–µ—Ä—ã –æ—à–∏–±–æ–∫:**
  ```json
  {
    "type": "https://api.example.com/errors/rate-limit-exceeded",
    "title": "Rate limit exceeded",
    "status": 429,
    "detail": "Too many requests in time window",
    "instance": "/api/v1/rate-limits/check",
    "retryAfter": 60
  }
  ```

**–ó–∞–¥–∞—á–∞ 2.1.3: GraphQL API (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)**
- **–°—Ö–µ–º–∞:** –†–∞–∑—Ä–∞–±–æ—Ç–∞—Ç—å GraphQL —Å—Ö–µ–º—É –¥–ª—è —Å–ª–æ–∂–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤
- **–§–µ–¥–µ—Ä–∞—Ü–∏—è:** –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–∞–º–∏

#### 2.2 –°—Ä–µ–¥–Ω–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç (3 –Ω–µ–¥–µ–ª–∏)

**–ó–∞–¥–∞—á–∞ 2.2.1: Batch –æ–ø–µ—Ä–∞—Ü–∏–∏**
- **–≠–Ω–¥–ø–æ–∏–Ω—Ç—ã:** 
  - `POST /api/v1/rate-limits/batch-check`
  - `POST /api/v1/blocks/batch-create`
- **–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è:** –£–º–µ–Ω—å—à–µ–Ω–∏–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –∑–∞–ø—Ä–æ—Å–æ–≤ –∫ –ë–î

**–ó–∞–¥–∞—á–∞ 2.2.2: WebSocket API –¥–ª—è —Ä–µ–∞–ª—å–Ω–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏**
- **–°–æ–±—ã—Ç–∏—è:** –ú–≥–Ω–æ–≤–µ–Ω–Ω—ã–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ –±–ª–æ–∫–∞—Ö
- **–ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è:** JWT —Ç–æ–∫–µ–Ω—ã
- **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:** –ê–¥–º–∏–Ω—Å–∫–∏–µ –¥–∞—à–±–æ—Ä–¥—ã

### 3. –£–ª—É—á—à–µ–Ω–∏–µ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –¥–∞–Ω–Ω—ã—Ö

#### 3.1 –í—ã—Å–æ–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç (2 –Ω–µ–¥–µ–ª–∏)

**–ó–∞–¥–∞—á–∞ 3.1.1: CQRS –ø–∞—Ç—Ç–µ—Ä–Ω**
- **Command —Å—Ç–æ—Ä–æ–Ω–∞:** –°–æ–∑–¥–∞–Ω–∏–µ/–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –±–ª–æ–∫–æ–≤
- **Query —Å—Ç–æ—Ä–æ–Ω–∞:** –ß—Ç–µ–Ω–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏, –æ—Ç—á–µ—Ç—ã
- **–•—Ä–∞–Ω–µ–Ω–∏–µ:** –û—Ç–¥–µ–ª—å–Ω—ã–µ –º–æ–¥–µ–ª–∏ –¥–ª—è —á—Ç–µ–Ω–∏—è/–∑–∞–ø–∏—Å–∏

**–ó–∞–¥–∞—á–∞ 3.1.2: Event Sourcing**
- **–°–æ–±—ã—Ç–∏—è:** –ü–æ–ª–Ω–∞—è –∏—Å—Ç–æ—Ä–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π —Å–æ—Å—Ç–æ—è–Ω–∏–π
- **–•—Ä–∞–Ω–µ–Ω–∏–µ:** –°–æ–±—ã—Ç–∏—è –∫–∞–∫ –∏—Å—Ç–æ—á–Ω–∏–∫ –∏—Å—Ç–∏–Ω—ã
- **–ü—Ä–æ–µ–∫—Ü–∏–∏:** –ú–∞—Ç–µ—Ä–∏–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è

#### 3.2 –°—Ä–µ–¥–Ω–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç (4 –Ω–µ–¥–µ–ª–∏)

**–ó–∞–¥–∞—á–∞ 3.2.1: Eventual consistency**
- **–°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è:** –ú–µ–∂–¥—É Redis –∏ Prisma
- **–ö–æ–Ω—Ñ–ª–∏–∫—Ç—ã:** –†–∞–∑—Ä–µ—à–µ–Ω–∏–µ –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤ –¥–∞–Ω–Ω—ã—Ö
- **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥:** –û—Ç—Å—Ç–∞–≤–∞–Ω–∏–µ —Ä–µ–ø–ª–∏–∫–∞—Ü–∏–∏

**–ó–∞–¥–∞—á–∞ 3.2.2: Cache invalidation —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏**
- **–¢–µ–≥–∏:** –ò–Ω–≤–∞–ª–∏–¥–∞—Ü–∏—è –ø–æ —Ç–µ–≥–∞–º
- **TTL:** –í—Ä–µ–º—è –∂–∏–∑–Ω–∏ –∫—ç—à–∞
- **Warm-up:** –ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞

---

## ‚ö° –ü–ª–∞–Ω —É–ª—É—á—à–µ–Ω–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

### 1. –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

#### 1.1 –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –∑–∞–¥–∞—á–∏ (1 –Ω–µ–¥–µ–ª—è)

**–ó–∞–¥–∞—á–∞ 1.1.1: –ê–Ω–∞–ª–∏–∑ –∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –∏–Ω–¥–µ–∫—Å–æ–≤**
- **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∏–Ω–¥–µ–∫—Å—ã:**
  ```sql
  -- –î–ª—è RateLimitState
  CREATE INDEX CONCURRENTLY idx_rate_limit_state_module_updated 
    ON "RateLimitState"(module, "updatedAt" DESC);
  
  CREATE INDEX CONCURRENTLY idx_rate_limit_state_blocked_until 
    ON "RateLimitState"("blockedUntil") WHERE "blockedUntil" IS NOT NULL;
  
  -- –î–ª—è RateLimitEvent
  CREATE INDEX CONCURRENTLY idx_rate_limit_event_module_key_event_type 
    ON "RateLimitEvent"(module, key, "eventType", "createdAt" DESC);
  
  -- –î–ª—è UserBlock
  CREATE INDEX CONCURRENTLY idx_user_block_active_module 
    ON "UserBlock"(isActive, module, "blockedAt" DESC);
  ```

**–ó–∞–¥–∞—á–∞ 1.1.2: –ú–∏–≥—Ä–∞—Ü–∏—è –Ω–∞ PostgreSQL**
- **–ü—Ä–∏—á–∏–Ω—ã:** –õ—É—á—à–∞—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –¥–ª—è –∞–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∏—Ö –∑–∞–ø—Ä–æ—Å–æ–≤
- **–≠—Ç–∞–ø—ã:**
  1. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ PostgreSQL –≤ Docker
  2. –ú–∏–≥—Ä–∞—Ü–∏—è —Å—Ö–µ–º—ã –¥–∞–Ω–Ω—ã—Ö
  3. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
  4. –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –ø—Ä–æ–¥–∞–∫—à–µ–Ω —Å—Ä–µ–¥—ã

#### 1.2 –°—Ä–µ–¥–Ω–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç (2 –Ω–µ–¥–µ–ª–∏)

**–ó–∞–¥–∞—á–∞ 1.2.1: –ü–∞—Ä—Ç–∏—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç–∞–±–ª–∏—Ü**
- **RateLimitEvent:** –ü–æ –º–µ—Å—è—Ü–∞–º (–≤—Ä–µ–º–µ–Ω–Ω–æ–µ –ø–∞—Ä—Ç–∏—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ)
- **UserBlock:** –ü–æ –º–æ–¥—É–ª—è–º
- **–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:** –ë—ã—Å—Ç—Ä–µ–µ –∑–∞–ø—Ä–æ—Å—ã, –ø—Ä–æ—â–µ –∞—Ä—Ö–∏–≤–∞—Ü–∏—è

**–ó–∞–¥–∞—á–∞ 1.2.2: Read Replicas**
- **Primary:** –û–ø–µ—Ä–∞—Ü–∏–∏ –∑–∞–ø–∏—Å–∏
- **Replicas:** –ê–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∏–µ –∑–∞–ø—Ä–æ—Å—ã, –æ—Ç—á–µ—Ç—ã
- **–ë–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∞:** –ù–∞ —É—Ä–æ–≤–Ω–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

### 2. –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏

#### 2.1 –í—ã—Å–æ–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç (1 –Ω–µ–¥–µ–ª—è)

**–ó–∞–¥–∞—á–∞ 2.1.1: Multi-layer caching**
- **L1:** In-memory (–¥–ª—è –∞–∫—Ç–∏–≤–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π)
- **L2:** Redis (–¥–ª—è —Å–µ—Å—Å–∏–π –∏ rate-limit)
- **L3:** CDN (–¥–ª—è —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏—Ö —Ä–µ—Å—É—Ä—Å–æ–≤)

**–ó–∞–¥–∞—á–∞ 2.1.2: Intelligent cache warming**
- **–ü–∞—Ç—Ç–µ—Ä–Ω—ã –¥–æ—Å—Ç—É–ø–∞:** –ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ –ø–æ–ø—É–ª—è—Ä–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- **–í—Ä–µ–º—è:** –¢–∏—Ö–æ–µ –≤—Ä–µ–º—è (–Ω–æ—á–Ω—ã–µ —á–∞—Å—ã)
- **–ú–µ—Ç—Ä–∏–∫–∏:** Hit rate > 90%

#### 2.2 –°—Ä–µ–¥–Ω–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç (2 –Ω–µ–¥–µ–ª–∏)

**–ó–∞–¥–∞—á–∞ 2.2.1: Cache stampede prevention**
- **–í–∞–ª–∏–¥–∞—Ü–∏—è:** Stale-While-Revalidate
- **–õ–æ–∫–∏:** –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–µ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏
- **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥:** –í—Ä–µ–º—è –æ—Ç–∫–ª–∏–∫–∞ –∫—ç—à–∞

**–ó–∞–¥–∞—á–∞ 2.2.2: Application-level caching**
- **–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏:** Rate-limit –ø—Ä–∞–≤–∏–ª–∞
- **–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:** –ê–≥—Ä–µ–≥–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
- **TTL:** 5 –º–∏–Ω—É—Ç –¥–ª—è –∫–æ–Ω—Ñ–∏–≥–æ–≤, 1 —á–∞—Å –¥–ª—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏

### 3. –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è API –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

#### 3.1 –í—ã—Å–æ–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç (1 –Ω–µ–¥–µ–ª—è)

**–ó–∞–¥–∞—á–∞ 3.1.1: Response compression**
- **Gzip/Brotli:** –î–ª—è JSON –æ—Ç–≤–µ—Ç–æ–≤
- **CDN:** CloudFlare —Å edge computing
- **–≠–∫–æ–Ω–æ–º–∏—è:** 60-80% —Ä–∞–∑–º–µ—Ä–∞ –æ—Ç–≤–µ—Ç–æ–≤

**–ó–∞–¥–∞—á–∞ 3.1.2: Connection pooling**
- **Prisma:** –û–ø—Ç–∏–º–∞–ª—å–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ pool
- **Redis:** Pipeline –¥–ª—è batch –æ–ø–µ—Ä–∞—Ü–∏–π
- **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π

#### 3.2 –°—Ä–µ–¥–Ω–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç (2 –Ω–µ–¥–µ–ª–∏)

**–ó–∞–¥–∞—á–∞ 3.2.1: Async processing**
- **–û—á–µ—Ä–µ–¥–∏:** –î–ª—è —Ä–µ—Å—É—Ä—Å–æ–µ–º–∫–∏—Ö –æ–ø–µ—Ä–∞—Ü–∏–π
- **–°–∏—Å—Ç–µ–º–∞:** BullMQ —Å Redis
- **–ü—Ä–∏–º–µ—Ä—ã:** –ú–∞—Å—Å–æ–≤—ã–µ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏, –æ—Ç—á–µ—Ç—ã

**–ó–∞–¥–∞—á–∞ 3.2.2: Database query optimization**
- **N+1 –ø—Ä–æ–±–ª–µ–º–∞:** –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ —á–µ—Ä–µ–∑ joins
- **–ü–∞–≥–∏–Ω–∞—Ü–∏—è:** Cursor-based –≤–º–µ—Å—Ç–æ offset
- **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥:** Slow query log

---

## üß™ –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—é

### 1. Unit —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

#### 1.1 –í—ã—Å–æ–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç (2 –Ω–µ–¥–µ–ª–∏)

**–ó–∞–¥–∞—á–∞ 1.1.1: –ü–æ–∫—Ä—ã—Ç–∏–µ RateLimit —Å–µ—Ä–≤–∏—Å–∞**
- **–§–∞–π–ª—ã –¥–ª—è –ø–æ–∫—Ä—ã—Ç–∏—è:**
  - `src/lib/rate-limit.ts` - –æ—Å–Ω–æ–≤–Ω–∞—è –ª–æ–≥–∏–∫–∞
  - `src/lib/rate-limit/stores/prisma-store.ts` - Prisma —Ö—Ä–∞–Ω–∏–ª–∏—â–µ
  - `src/lib/rate-limit/stores/redis-store.ts` - Redis —Ö—Ä–∞–Ω–∏–ª–∏—â–µ
- **–¢–µ—Å—Ç–æ–≤—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏:**
  ```typescript
  describe('RateLimitService', () => {
    test('–¥–æ–ª–∂–µ–Ω –±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–∏ –ø—Ä–µ–≤—ã—à–µ–Ω–∏–∏ –ª–∏–º–∏—Ç–∞')
    test('–¥–æ–ª–∂–µ–Ω —Å–±—Ä–∞—Å—ã–≤–∞—Ç—å —Å—á–µ—Ç—á–∏–∫ –ø–æ –∏—Å—Ç–µ—á–µ–Ω–∏–∏ –æ–∫–Ω–∞')
    test('–¥–æ–ª–∂–µ–Ω –¥–µ–¥—É–ø–ª–∏—Ü–∏—Ä–æ–≤–∞—Ç—å —Å–æ–±—ã—Ç–∏—è –≤ monitor —Ä–µ–∂–∏–º–µ')
    test('–¥–æ–ª–∂–µ–Ω fallback –Ω–∞ Prisma –ø—Ä–∏ –æ—à–∏–±–∫–µ Redis')
    test('–¥–æ–ª–∂–µ–Ω –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å –Ω–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–µ –º–æ–¥—É–ª–∏')
  })
  ```

**–ó–∞–¥–∞—á–∞ 1.1.2: –ü–æ–∫—Ä—ã—Ç–∏–µ —Ö—Ä–∞–Ω–∏–ª–∏—â –¥–∞–Ω–Ω—ã—Ö**
- **PrismaStore —Ç–µ—Å—Ç—ã:**
  - –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã–µ –∏–Ω–∫—Ä–µ–º–µ–Ω—Ç—ã (race conditions)
  - –¢—Ä–∞–Ω–∑–∞–∫—Ü–∏–æ–Ω–Ω–∞—è —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç—å
  - –°–±—Ä–æ—Å –∫—ç—à–∞
- **RedisStore —Ç–µ—Å—Ç—ã:**
  - –î–µ–¥—É–ø–ª–∏–∫–∞—Ü–∏—è —Å–æ–±—ã—Ç–∏–π
  - TTL –¥–ª—è –∫–ª—é—á–µ–π
  - Recovery –ø–æ—Å–ª–µ –æ—Ç–∫–ª—é—á–µ–Ω–∏—è

#### 1.2 –°—Ä–µ–¥–Ω–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç (3 –Ω–µ–¥–µ–ª–∏)

**–ó–∞–¥–∞—á–∞ 1.2.1: –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –∏ –≤–∞–ª–∏–¥–∞—Ü–∏—è**
- **–í—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ:** Boundary testing –¥–ª—è –≤—Å–µ—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
- **SQL –∏–Ω—ä–µ–∫—Ü–∏–∏:** –¢–µ—Å—Ç—ã –Ω–∞ –∑–∞—â–∏—â–µ–Ω–Ω–æ—Å—Ç—å
- **XSS:** –°–∞–Ω–∏—Ç–∏–∑–∞—Ü–∏—è –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö

**–ó–∞–¥–∞—á–∞ 1.2.2: –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å**
- **Benchmark —Ç–µ—Å—Ç—ã:** –í—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –æ–ø–µ—Ä–∞—Ü–∏–π
- **Memory leaks:** –ü—Ä–æ–≤–µ—Ä–∫–∞ —É—Ç–µ—á–µ–∫ –ø–∞–º—è—Ç–∏
- **Stress testing:** –ù–∞–≥—Ä—É–∑–æ—á–Ω—ã–µ —Ç–µ—Å—Ç—ã

### 2. Integration —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

#### 2.1 –í—ã—Å–æ–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç (2 –Ω–µ–¥–µ–ª–∏)

**–ó–∞–¥–∞—á–∞ 2.1.1: API –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã**
- **–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç:** Supertest + Jest
- **–ü–æ–∫—Ä—ã—Ç–∏–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç–æ–≤:**
  - `POST /api/admin/rate-limits` - —Å–æ–∑–¥–∞–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥–∞
  - `GET /api/admin/rate-limits` - –ø–æ–ª—É—á–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞
  - `POST /api/admin/rate-limits/blocks` - —Å–æ–∑–¥–∞–Ω–∏–µ –±–ª–æ–∫–∞
  - `DELETE /api/admin/rate-limits/:id` - —É–¥–∞–ª–µ–Ω–∏–µ

**–ó–∞–¥–∞—á–∞ 2.1.2: Database –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è**
- **Testcontainers:** PostgreSQL –≤ Docker
- **–°—Ü–µ–Ω–∞—Ä–∏–∏:**
  - –ú–∏–≥—Ä–∞—Ü–∏–∏ —Å—Ö–µ–º—ã
  - –¢—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏
  - –†–µ–ø–ª–∏–∫–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö

#### 2.2 –°—Ä–µ–¥–Ω–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç (3 –Ω–µ–¥–µ–ª–∏)

**–ó–∞–¥–∞—á–∞ 2.2.1: Redis –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è**
- **Testcontainers:** Redis –≤ Docker
- **–°—Ü–µ–Ω–∞—Ä–∏–∏:**
  - Fallback Redis ‚Üí Prisma
  - –û—á–∏—Å—Ç–∫–∞ –∫—ç—à–∞
  - Pipeline –æ–ø–µ—Ä–∞—Ü–∏–∏

**–ó–∞–¥–∞—á–∞ 2.2.2: WebSocket –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è**
- **–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç:** Socket.IO testing utilities
- **–°—Ü–µ–Ω–∞—Ä–∏–∏:**
  - –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è —á–µ—Ä–µ–∑ WebSocket
  - Real-time —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ –±–ª–æ–∫–∞—Ö
  - Room management

### 3. End-to-End —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

#### 3.1 –°—Ä–µ–¥–Ω–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç (4 –Ω–µ–¥–µ–ª–∏)

**–ó–∞–¥–∞—á–∞ 3.1.1: Playwright E2E —Ç–µ—Å—Ç—ã**
- **–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏:**
  - –°–æ–∑–¥–∞–Ω–∏–µ –æ–±—ä—è–≤–ª–µ–Ω–∏—è —Å rate limiting
  - –ú–∞—Å—Å–æ–≤–∞—è –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ —á–µ—Ä–µ–∑ –∞–¥–º–∏–Ω–∫—É
  - –ü—Ä–æ—Å–º–æ—Ç—Ä —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
  - –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–æ—Å–ª–µ —Å–±–æ—è Redis

**–ó–∞–¥–∞—á–∞ 3.1.2: Accessibility —Ç–µ—Å—Ç—ã**
- **–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç:** axe-core –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è
- **–ö—Ä–∏—Ç–µ—Ä–∏–∏:** WCAG 2.1 AA
- **–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç–Ω—ã–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã:** –ê–¥–º–∏–Ω –ø–∞–Ω–µ–ª—å, —Ñ–æ—Ä–º—ã –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏

#### 3.2 –ù–∏–∑–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç (2 –Ω–µ–¥–µ–ª–∏)

**–ó–∞–¥–∞—á–∞ 3.2.1: Performance E2E —Ç–µ—Å—Ç—ã**
- **–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç:** Lighthouse CI
- **–ú–µ—Ç—Ä–∏–∫–∏:** 
  - First Contentful Paint < 1.5s
  - Time to Interactive < 3.5s
  - Cumulative Layout Shift < 0.1

**–ó–∞–¥–∞—á–∞ 3.2.2: Cross-browser —Ç–µ—Å—Ç—ã**
- **–ë—Ä–∞—É–∑–µ—Ä—ã:** Chrome, Firefox, Safari, Edge
- **–£—Å—Ç—Ä–æ–π—Å—Ç–≤–∞:** Desktop, Mobile, Tablet
- **–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç:** BrowserStack –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è

### 4. Continuous Integration

#### 4.1 –í—ã—Å–æ–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç (1 –Ω–µ–¥–µ–ª—è)

**–ó–∞–¥–∞—á–∞ 4.1.1: GitHub Actions pipeline**
- **–≠—Ç–∞–ø—ã:**
  1. Linting (ESLint, Prettier)
  2. Type checking (tsc --noEmit)
  3. Unit —Ç–µ—Å—Ç—ã
  4. Integration —Ç–µ—Å—Ç—ã
  5. Security scan (npm audit)
  6. Build optimization check

**–ó–∞–¥–∞—á–∞ 4.1.2: Quality gates**
- **–ü–æ–∫—Ä—ã—Ç–∏–µ –∫–æ–¥–∞:** > 80%
- **–¢–µ—Å—Ç–æ–≤—ã–µ —Ñ–µ–π–ª—ã:** 0
- **Security vulnerabilities:** High/Critical = 0
- **Performance regression:** < 10%

#### 4.2 –°—Ä–µ–¥–Ω–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç (2 –Ω–µ–¥–µ–ª–∏)

**–ó–∞–¥–∞—á–∞ 4.2.1: Automated dependency updates**
- **Dependabot:** –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ PR –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π
- **Renovate:** –ë–æ–ª–µ–µ –≥–∏–±–∫–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞
- **Security patches:** –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ

**–ó–∞–¥–∞—á–∞ 4.2.2: Release pipeline**
- **Semantic versioning:** –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π changelog
- **Docker image:** Multi-stage builds
- **Rollback strategy:** Blue-green deployments

---

## üìö –ü–ª–∞–Ω –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏

### 1. –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

#### 1.1 –í—ã—Å–æ–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç (2 –Ω–µ–¥–µ–ª–∏)

**–ó–∞–¥–∞—á–∞ 1.1.1: API –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è**
- **–§–æ—Ä–º–∞—Ç:** OpenAPI 3.0 —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏–∏
- **–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç:** Swagger UI
- **–°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ:**
  - –í—Å–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã —Å –ø—Ä–∏–º–µ—Ä–∞–º–∏
  - –°—Ö–µ–º—ã –¥–∞–Ω–Ω—ã—Ö
  - –ö–æ–¥—ã –æ—à–∏–±–æ–∫
  - Rate limiting –¥–ª—è API –∫–ª–∏–µ–Ω—Ç–æ–≤
- **–†–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ:** `/docs/api`

**–ó–∞–¥–∞—á–∞ 1.1.2: –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã**
- **ADR (Architecture Decision Records):**
  - –í—ã–±–æ—Ä Prisma ORM
  - Resilient –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ rate-limit
  - –°—Ç—Ä–∞—Ç–µ–≥–∏—è –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è
  - –ú–∏–≥—Ä–∞—Ü–∏—è –Ω–∞ PostgreSQL
- **–î–∏–∞–≥—Ä–∞–º–º—ã:** C4 Model (Context, Container, Component, Code)

**–ó–∞–¥–∞—á–∞ 1.1.3: –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è**
- **Security.md:** –û–±—â–∏–µ –ø—Ä–∏–Ω—Ü–∏–ø—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
- **GDPR-compliance.md:** –°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è–º
- **Incident response plan:** –ü—Ä–æ—Ü–µ–¥—É—Ä—ã —Ä–µ–∞–≥–∏—Ä–æ–≤–∞–Ω–∏—è
- **Security audit checklist:** –†–µ–≥—É–ª—è—Ä–Ω—ã–µ –ø—Ä–æ–≤–µ—Ä–∫–∏

#### 1.2 –°—Ä–µ–¥–Ω–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç (3 –Ω–µ–¥–µ–ª–∏)

**–ó–∞–¥–∞—á–∞ 1.2.1: –û–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è**
- **Runbooks:**
  - Scaling Redis –∫–ª–∞—Å—Ç–µ—Ä–∞
  - –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –∞–ª–µ—Ä—Ç—ã
  - –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–æ—Å–ª–µ —Å–±–æ—è
  - –†–æ—Ç–∞—Ü–∏—è –∫–ª—é—á–µ–π —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è
- **Deployment guide:** –ü–æ—à–∞–≥–æ–≤–æ–µ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ
- **Configuration reference:** –í—Å–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

**–ó–∞–¥–∞—á–∞ 1.2.2: –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å**
- **Performance tuning guide:** –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ë–î, –∫—ç—à–∞
- **Monitoring dashboard guide:** –ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è –º–µ—Ç—Ä–∏–∫
- **Capacity planning:** –†–∞—Å—á–µ—Ç –Ω–∞–≥—Ä—É–∑–∫–∏ –∏ —Ä–µ—Å—É—Ä—Å–æ–≤

### 2. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

#### 2.1 –í—ã—Å–æ–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç (2 –Ω–µ–¥–µ–ª–∏)

**–ó–∞–¥–∞—á–∞ 2.1.1: –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—Å–∫–∏–π –≥–∞–π–¥**
- **–†–∞–∑–¥–µ–ª—ã:**
  - –í—Ö–æ–¥ –≤ –∞–¥–º–∏–Ω –ø–∞–Ω–µ–ª—å
  - –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ rate-limit –ø—Ä–∞–≤–∏–ª–∞–º–∏
  - –°–æ–∑–¥–∞–Ω–∏–µ –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –±–ª–æ–∫–∞–º–∏
  - –ü—Ä–æ—Å–º–æ—Ç—Ä —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –∏ –æ—Ç—á–µ—Ç–æ–≤
  - –û–±—Ä–∞–±–æ—Ç–∫–∞ –∏–Ω—Ü–∏–¥–µ–Ω—Ç–æ–≤
- **–§–æ—Ä–º–∞—Ç:** Markdown + —Å–∫—Ä–∏–Ω—à–æ—Ç—ã
- **–Ø–∑—ã–∫–∏:** –†—É—Å—Å–∫–∏–π, –ê–Ω–≥–ª–∏–π—Å–∫–∏–π

**–ó–∞–¥–∞—á–∞ 2.1.2: FAQ –¥–ª—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤**
- **–¢–∏–ø–∏—á–Ω—ã–µ –≤–æ–ø—Ä–æ—Å—ã:**
  - –ü–æ—á–µ–º—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω?
  - –ö–∞–∫ —Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è?
  - –ß—Ç–æ –æ–∑–Ω–∞—á–∞—é—Ç –º–µ—Ç—Ä–∏–∫–∏ –≤ Grafana?
  - –ö–∞–∫ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å –ø—Ä–∞–≤–∏–ª–∞ rate limiting?

#### 2.2 –°—Ä–µ–¥–Ω–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç (2 –Ω–µ–¥–µ–ª–∏)

**–ó–∞–¥–∞—á–∞ 2.2.1: Developer documentation**
- **Getting started guide:** –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤
- **Contributing guidelines:** –ö–∞–∫ –≤–Ω–æ—Å–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è
- **Code style guide:** –°—Ç–∞–Ω–¥–∞—Ä—Ç—ã –∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏—è
- **Testing guidelines:** –ö–∞–∫ –ø–∏—Å–∞—Ç—å —Ç–µ—Å—Ç—ã

**–ó–∞–¥–∞—á–∞ 2.2.2: Integration guide**
- **API usage examples:** –ü—Ä–∏–º–µ—Ä—ã –¥–ª—è —Ä–∞–∑–Ω—ã—Ö —è–∑—ã–∫–æ–≤
- **Webhooks documentation:** –°–æ–±—ã—Ç–∏—è –¥–ª—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–π
- **Rate limiting –¥–ª—è –∫–ª–∏–µ–Ω—Ç–æ–≤:** –ö–∞–∫ –ø—Ä–∞–≤–∏–ª—å–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å

### 3. –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤

#### 3.1 –°—Ä–µ–¥–Ω–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç (1 –Ω–µ–¥–µ–ª—è)

**–ó–∞–¥–∞—á–∞ 3.1.1: –†–µ–≤—å—é —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤**
- **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∞–∫—Ç—É–∞–ª—å–Ω–æ—Å—Ç—å:**
  - `docs/monitoring.md`
  - `docs/testing/unit-tests.md`
  - `docs/TODO.md`
- **–û–±–Ω–æ–≤–∏—Ç—å —É—Å—Ç–∞—Ä–µ–≤—à–∏–µ —Ä–∞–∑–¥–µ–ª—ã**
- **–£–¥–∞–ª–∏—Ç—å –Ω–µ–∞–∫—Ç—É–∞–ª—å–Ω—ã–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏**

**–ó–∞–¥–∞—á–∞ 3.1.2: –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å —Å–∏—Å—Ç–µ–º–∞–º–∏ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏**
- **GitBook/Notion:** –î–ª—è —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–æ–π –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏
- **Confluence:** –î–ª—è –±–∏–∑–Ω–µ—Å-–¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏
- **Automated sync:** –ü—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è—Ö –≤ –∫–æ–¥–µ

#### 3.2 –ù–∏–∑–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç (1 –Ω–µ–¥–µ–ª—è)

**–ó–∞–¥–∞—á–∞ 3.2.1: –í–∏–¥–µ–æ —Ç—É—Ç–æ—Ä–∏–∞–ª—ã**
- **–ê–¥–º–∏–Ω –ø–∞–Ω–µ–ª—å:** –û–±–∑–æ—Ä –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞
- **–°–æ–∑–¥–∞–Ω–∏–µ –±–ª–æ–∫–æ–≤:** –ü–æ—à–∞–≥–æ–≤–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ
- **–ê–Ω–∞–ª–∏–∑ –º–µ—Ç—Ä–∏–∫:** –ö–∞–∫ —á–∏—Ç–∞—Ç—å Grafana –¥–∞—à–±–æ—Ä–¥—ã

**–ó–∞–¥–∞—á–∞ 3.2.2: –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è**
- **API Explorer:** –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ API
- **Configuration wizard:** –ü–æ–º–æ—â–Ω–∏–∫ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
- **Troubleshooting assistant:** –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –ø—Ä–æ–±–ª–µ–º

---

## üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –º–µ—Ç—Ä–∏–∫–∏

### 1. –†–∞—Å—à–∏—Ä–µ–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞

#### 1.1 –í—ã—Å–æ–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç (1 –Ω–µ–¥–µ–ª—è)

**–ó–∞–¥–∞—á–∞ 1.1.1: –ë–∏–∑–Ω–µ—Å-–º–µ—Ç—Ä–∏–∫–∏**
- **–ë–ª–æ–∫–∏—Ä–æ–≤–∫–∏ –ø–æ —Ç–∏–ø–∞–º:** –°–ø–∞–º, —Ñ–ª—É–¥, –∑–ª–æ—É–ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏—è
- **–õ–æ–∂–Ω—ã–µ —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏—è:** –°–æ–æ—Ç–Ω–æ—à–µ–Ω–∏–µ –∫ –≤–∞–ª–∏–¥–Ω—ã–º –±–ª–æ–∫–∞–º
- **–í—Ä–µ–º—è —Ä–µ–∞–∫—Ü–∏–∏:** –û—Ç –Ω–∞—Ä—É—à–µ–Ω–∏—è –¥–æ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏
- **–≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å:** % –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ —Å–ø–∞–º–∞

**–ó–∞–¥–∞—á–∞ 1.1.2: Security –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã**
- **–ê–Ω–æ–º–∞–ª—å–Ω–∞—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å:** –ü–æ–∏—Å–∫–æ–≤—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã
- **–ì–µ–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏–µ –∞–Ω–æ–º–∞–ª–∏–∏:** –ù–µ–æ–±—ã—á–Ω—ã–µ –ª–æ–∫–∞—Ü–∏–∏
- **Device fingerprinting:** –ü–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞

#### 1.2 –°—Ä–µ–¥–Ω–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç (2 –Ω–µ–¥–µ–ª–∏)

**–ó–∞–¥–∞—á–∞ 1.2.1: Performance –º–µ—Ç—Ä–∏–∫–∏**
- **Database performance:** Query time, connection pool
- **Cache hit rate:** Redis effectiveness
- **API latency:** Response time percentiles

**–ó–∞–¥–∞—á–∞ 1.2.2: User experience –º–µ—Ç—Ä–∏–∫–∏**
- **Admin UX:** –í—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∑–∞–¥–∞—á
- **False positive rate:** –ù–µ–æ–±–æ—Å–Ω–æ–≤–∞–Ω–Ω—ã–µ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏
- **Appeal success rate:** –£—Å–ø–µ—à–Ω–æ—Å—Ç—å –∞–ø–µ–ª–ª—è—Ü–∏–π

### 2. –ê–ª–µ—Ä—Ç—ã –∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è

#### 2.1 –í—ã—Å–æ–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç (1 –Ω–µ–¥–µ–ª—è)

**–ó–∞–¥–∞—á–∞ 2.1.1: Critical –∞–ª–µ—Ä—Ç—ã**
- **–°–∏—Å—Ç–µ–º–∞ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∞:** Rate limiting –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç
- **Storage –æ—Ç–∫–∞–∑:** Redis –∏ PostgreSQL down
- **Security –∏–Ω—Ü–∏–¥–µ–Ω—Ç—ã:** –ú–∞—Å—Å–æ–≤—ã–µ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏
- **Performance –¥–µ–≥—Ä–∞–¥–∞—Ü–∏—è:** Response time > 2s

**–ó–∞–¥–∞—á–∞ 2.1.2: Warning –∞–ª–µ—Ä—Ç—ã**
- **–í—ã—Å–æ–∫–∞—è –Ω–∞–≥—Ä—É–∑–∫–∞:** CPU/Memory > 80%
- **Cache misses:** Hit rate < 70%
- **Unknown modules:** –ù–æ–≤—ã–µ –º–æ–¥—É–ª–∏ –±–µ–∑ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏

#### 2.2 –°—Ä–µ–¥–Ω–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç (2 –Ω–µ–¥–µ–ª–∏)

**–ó–∞–¥–∞—á–∞ 2.2.1: Business –∞–ª–µ—Ä—Ç—ã**
- **–ê–Ω–æ–º–∞–ª–∏–∏ –≤ –¥–∞–Ω–Ω—ã—Ö:** –ù–µ–æ–∂–∏–¥–∞–Ω–Ω—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã
- **–°–µ–∑–æ–Ω–Ω—ã–µ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏—è:** –í—ã—Ö–æ–¥ –∑–∞ –æ–±—ã—á–Ω—ã–µ —Ä–∞–º–∫–∏
- **Weekly reports:** –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ —Å–≤–æ–¥–∫–∏

**–ó–∞–¥–∞—á–∞ 2.2.2: Alert fatigue prevention**
- **Smart grouping:** –ì—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ —Å–≤—è–∑–∞–Ω–Ω—ã—Ö –∞–ª–µ—Ä—Ç–æ–≤
- **Escalation policies:** –≠—Å–∫–∞–ª–∞—Ü–∏—è –ø—Ä–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ —Ä–µ–∞–∫—Ü–∏–∏
- **Maintenance windows:** –¢–∏—Ö–∏–µ –ø–µ—Ä–∏–æ–¥—ã –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π

---

## üéØ –ü—Ä–∏–æ—Ä–∏—Ç–∏–∑–∞—Ü–∏—è –∏ roadmap

### –§–∞–∑–∞ 1: Critical Fixes (–ù–µ–¥–µ–ª–∏ 1-2)
1. **PII-—Ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ**
2. **–î–æ–±–∞–≤–ª–µ–Ω–∏–µ –∏–Ω–¥–µ–∫—Å–æ–≤ –ë–î**
3. **Security headers –∏ CSP**
4. **Unit —Ç–µ—Å—Ç—ã –¥–ª—è –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤**
5. **API –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è**

### –§–∞–∑–∞ 2: Security Hardening (–ù–µ–¥–µ–ª–∏ 3-4)
1. **MFA –¥–ª—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤**
2. **Session hardening**
3. **CSRF –∑–∞—â–∏—Ç–∞**
4. **Rate limiting –¥–ª—è auth endpoints**
5. **GDPR –ø–æ–ª–∏—Ç–∏–∫–∏ —Ö—Ä–∞–Ω–µ–Ω–∏—è**

### –§–∞–∑–∞ 3: Performance Optimization (–ù–µ–¥–µ–ª–∏ 5-6)
1. **–ú–∏–≥—Ä–∞—Ü–∏—è –Ω–∞ PostgreSQL**
2. **Multi-layer caching**
3. **Connection pooling –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è**
4. **Integration —Ç–µ—Å—Ç—ã**
5. **Performance E2E —Ç–µ—Å—Ç—ã**

### –§–∞–∑–∞ 4: Architecture Improvements (–ù–µ–¥–µ–ª–∏ 7-10)
1. **Feature-first —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥**
2. **CQRS –≤–Ω–µ–¥—Ä–µ–Ω–∏–µ**
3. **Event sourcing**
4. **Async processing –æ—á–µ—Ä–µ–¥–∏**
5. **Advanced monitoring**

### –§–∞–∑–∞ 5: Polish & Documentation (–ù–µ–¥–µ–ª–∏ 11-12)
1. **–û–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è**
2. **–í–∏–¥–µ–æ —Ç—É—Ç–æ—Ä–∏–∞–ª—ã**
3. **Alert fine-tuning**
4. **Security audit**
5. **Production readiness review**

---

## üí∞ –û—Ü–µ–Ω–∫–∞ —Ä–µ—Å—É—Ä—Å–æ–≤ –∏ ROI

### –ß–µ–ª–æ–≤–µ–∫–æ-—á–∞—Å—ã

| –§–∞–∑–∞ | Senior Developer | DevOps Engineer | Security Specialist | QA Engineer | Documentation |
|------|------------------|-----------------|---------------------|-------------|---------------|
| 1    | 80—á             | 20—á             | 16—á                 | 32—á         | 16—á          |
| 2    | 64—á             | 24—á             | 40—á                 | 24—á         | 24—á          |
| 3    | 96—á             | 40—á             | 16—á                 | 48—á         | 16—á          |
| 4    | 120—á            | 32—á             | 8—á                  | 32—á         | 24—á          |
| 5    | 48—á             | 16—á             | 8—á                  | 24—á         | 48—á          |
| **–ò—Ç–æ–≥–æ** | **408—á**       | **132—á**        | **88—á**             | **160—á**    | **128—á**     |

**–û–±—â–∞—è –æ—Ü–µ–Ω–∫–∞:** 776 —á–µ–ª–æ–≤–µ–∫–æ-—á–∞—Å–æ–≤ (~4 –º–µ—Å—è—Ü–∞ —Ä–∞–±–æ—Ç—ã –æ–¥–Ω–æ–≥–æ —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞)

### –ò–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–Ω—ã–µ –∑–∞—Ç—Ä–∞—Ç—ã

| –ö–æ–º–ø–æ–Ω–µ–Ω—Ç | –ï–∂–µ–º–µ—Å—è—á–Ω–∞—è —Å—Ç–æ–∏–º–æ—Å—Ç—å | –û–ø–∏—Å–∞–Ω–∏–µ |
|-----------|----------------------|----------|
| PostgreSQL (managed) | $200-500 | AWS RDS / Google Cloud SQL |
| Redis Cluster | $150-300 | AWS ElastiCache / Redis Cloud |
| CDN | $50-100 | CloudFlare / AWS CloudFront |
| Monitoring | $100-200 | Grafana Cloud / DataDog |
| Security scanning | $50-100 | Snyk / SonarQube |
| **–ò—Ç–æ–≥–æ** | **$550-1200** | |

### –û–∂–∏–¥–∞–µ–º—ã–π ROI

**–£–º–µ–Ω—å—à–µ–Ω–∏–µ –∑–∞—Ç—Ä–∞—Ç:**
- –°–Ω–∏–∂–µ–Ω–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω—ã—Ö –∏–Ω—Ü–∏–¥–µ–Ω—Ç–æ–≤ –Ω–∞ 60%
- –£–º–µ–Ω—å—à–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏ –Ω–∞ —Ä—É—á–Ω–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –±–ª–æ–∫–∞–º–∏ –Ω–∞ 40%
- –°–Ω–∏–∂–µ–Ω–∏–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –ª–æ–∂–Ω—ã—Ö —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏–π –Ω–∞ 30%

**–£–≤–µ–ª–∏—á–µ–Ω–∏–µ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏:**
- –ü–æ–≤—ã—à–µ–Ω–∏–µ –ø—Ä–æ–ø—É—Å–∫–Ω–æ–π —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏ –Ω–∞ 50%
- –£–ª—É—á—à–µ–Ω–∏–µ time-to-market –Ω–æ–≤—ã—Ö —Ñ–∏—á –Ω–∞ 25%
- –°–Ω–∏–∂–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏ –æ—Ç–∫–ª–∏–∫–∞ –ø–æ–¥–¥–µ—Ä–∂–∫–∏ –Ω–∞ 35%

**–û–∂–∏–¥–∞–µ–º—ã–π —Å—Ä–æ–∫ –æ–∫—É–ø–∞–µ–º–æ—Å—Ç–∏:** 6-8 –º–µ—Å—è—Ü–µ–≤

---

## ‚úÖ –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

–ü–ª–∞–Ω —É–ª—É—á—à–µ–Ω–∏–π –¥–ª—è –¥–æ—Å–∫–∏ –æ–±—ä—è–≤–ª–µ–Ω–∏–π –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π –∫–æ–º–ø–ª–µ–∫—Å–Ω—É—é —Å—Ç—Ä–∞—Ç–µ–≥–∏—é —Ä–∞–∑–≤–∏—Ç–∏—è, –æ—Ä–∏–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω—É—é –Ω–∞:

1. **–ü–æ–≤—ã—à–µ–Ω–∏–µ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏** - GDPR compliance, –∑–∞—â–∏—Ç–∞ –æ—Ç –∞—Ç–∞–∫, secure-by-design
2. **–£–ª—É—á—à–µ–Ω–∏–µ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏** - –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ë–î, –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ, –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ
3. **–ü–æ–≤—ã—à–µ–Ω–∏–µ –∫–∞—á–µ—Å—Ç–≤–∞ –∫–æ–¥–∞** - —Ç–∏–ø–∏–∑–∞—Ü–∏—è, —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ, –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã
4. **–£–ª—É—á—à–µ–Ω–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω–æ–π –ø–æ–¥–¥–µ—Ä–∂–∫–∏** - –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥, –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è, –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è

–†–µ–∞–ª–∏–∑–∞—Ü–∏—è —ç—Ç–æ–≥–æ –ø–ª–∞–Ω–∞ –ø—Ä–µ–≤—Ä–∞—Ç–∏—Ç –ø—Ä–æ–µ–∫—Ç –∏–∑ "—Ä–∞–±–æ—Ç–∞—é—â–µ–≥–æ –ø—Ä–æ—Ç–æ—Ç–∏–ø–∞" –≤ "production-ready —Ä–µ—à–µ–Ω–∏–µ enterprise-–∫–ª–∞—Å—Å–∞" —Å –≤—ã—Å–æ–∫–∏–º —É—Ä–æ–≤–Ω–µ–º –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç–∏, –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –∏ maintainability.

**–°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏:**
1. –°–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏–µ –ø–ª–∞–Ω–∞ —Å –∫–æ–º–∞–Ω–¥–æ–π
2. –ü—Ä–∏–æ—Ä–∏—Ç–∏–∑–∞—Ü–∏—è –∑–∞–¥–∞—á –ø–æ —Ä–µ—Å—É—Ä—Å–∞–º
3. –°–æ–∑–¥–∞–Ω–∏–µ –¥–µ—Ç–∞–ª—å–Ω—ã—Ö —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏—Ö –∑–∞–¥–∞–Ω–∏–π
4. –ü–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –∏—Ç–µ—Ä–∞—Ü–∏–π —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏
5. –ù–∞—á–∞–ª–æ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ —Ñ–∞–∑—ã 1