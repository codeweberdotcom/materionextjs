# –ü–ª–∞–Ω: useFormMedia - —Ö—É–∫ –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –º–µ–¥–∏–∞ –≤ —Ñ–æ—Ä–º–∞—Ö –æ–±—ä—è–≤–ª–µ–Ω–∏–π

**–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è:** 2025-11-28  
**–°—Ç–∞—Ç—É—Å:** –ü–ª–∞–Ω–∏—Ä—É–µ—Ç—Å—è  
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** –°—Ä–µ–¥–Ω–∏–π

---

## üéØ –¶–µ–ª—å

–°–æ–∑–¥–∞—Ç—å —Å–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π React-—Ö—É–∫ `useFormMedia` –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –º–µ–¥–∏–∞ —Ñ–∞–π–ª–∞–º–∏ –≤ —Ñ–æ—Ä–º–∞—Ö —Å–æ–∑–¥–∞–Ω–∏—è/—Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –æ–±—ä—è–≤–ª–µ–Ω–∏–π. –•—É–∫ –¥–æ–ª–∂–µ–Ω —Ö—Ä–∞–Ω–∏—Ç—å —Ñ–∞–π–ª—ã –Ω–∞ –∫–ª–∏–µ–Ω—Ç–µ –¥–æ –º–æ–º–µ–Ω—Ç–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ —Ñ–æ—Ä–º—ã, –æ–±–µ—Å–ø–µ—á–∏–≤–∞—è –æ–ø—Ç–∏–º–∞–ª—å–Ω—ã–π UX –∏ —ç–∫–æ–Ω–æ–º–∏—é —Å–µ—Ä–≤–µ—Ä–Ω—ã—Ö —Ä–µ—Å—É—Ä—Å–æ–≤.

---

## üìã –°–≤—è–∑–∞–Ω–Ω—ã–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã

- [useBulkUpload](../../../src/hooks/useBulkUpload.ts) - —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π —Ö—É–∫ –¥–ª—è –º–∞—Å—Å–æ–≤–æ–π –∑–∞–≥—Ä—É–∑–∫–∏ (MediaLibrary)
- [AI_MODULE_STANDARDS](../../AI_MODULE_STANDARDS.md) - —Å—Ç–∞–Ω–¥–∞—Ä—Ç—ã —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ –º–æ–¥—É–ª–µ–π
- [Media Service](../../../src/services/media/) - —Å–µ—Ä–≤–∏—Å –º–µ–¥–∏–∞ —Ñ–∞–π–ª–æ–≤

---

## üîç –ö–æ–Ω—Ç–µ–∫—Å—Ç –∏ –æ–±–æ—Å–Ω–æ–≤–∞–Ω–∏–µ

### –ü—Ä–æ–±–ª–µ–º–∞

–ü—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –æ–±—ä—è–≤–ª–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å:
1. –í—ã–±–∏—Ä–∞–µ—Ç —Ñ–æ—Ç–æ ‚Üí –•–æ—á–µ—Ç —Å—Ä–∞–∑—É –≤–∏–¥–µ—Ç—å –ø—Ä–µ–≤—å—é
2. –ú–µ–Ω—è–µ—Ç –ø–æ—Ä—è–¥–æ–∫ —Ñ–æ—Ç–æ ‚Üí Drag & Drop
3. –£–¥–∞–ª—è–µ—Ç —Ñ–æ—Ç–æ ‚Üí –ü–µ—Ä–µ–¥—É–º–∞–ª
4. –î–æ–±–∞–≤–ª—è–µ—Ç –Ω–æ–≤—ã–µ —Ñ–æ—Ç–æ ‚Üí –ó–∞–º–µ–Ω–∞
5. –ú–æ–∂–µ—Ç –∑–∞–∫—Ä—ã—Ç—å —Ñ–æ—Ä–º—É –∏ –Ω–µ –æ–ø—É–±–ª–∏–∫–æ–≤–∞—Ç—å –æ–±—ä—è–≤–ª–µ–Ω–∏–µ

**–ï—Å–ª–∏ –∑–∞–≥—Ä—É–∂–∞—Ç—å –∫–∞–∂–¥–æ–µ —Ñ–æ—Ç–æ —Å—Ä–∞–∑—É:**
- ‚ùå –ù–∞–≥—Ä—É–∑–∫–∞ –Ω–∞ —Å–µ—Ä–≤–µ—Ä –ø—Ä–∏ –∫–∞–∂–¥–æ–º –¥–µ–π—Å—Ç–≤–∏–∏
- ‚ùå –ú—É—Å–æ—Ä–Ω—ã–µ —Ñ–∞–π–ª—ã –æ—Ç –Ω–µ–∑–∞–≤–µ—Ä—à—ë–Ω–Ω—ã—Ö —Ñ–æ—Ä–º
- ‚ùå –õ–∏—à–Ω–∏–µ –∑–∞–¥–∞—á–∏ –≤ –æ—á–µ—Ä–µ–¥–∏ –æ–±—Ä–∞–±–æ—Ç–∫–∏
- ‚ùå –ó–∞–¥–µ—Ä–∂–∫–∏ –ø—Ä–∏ –∫–∞–∂–¥–æ–º –≤—ã–±–æ—Ä–µ —Ñ–∞–π–ª–∞

### –†–µ—à–µ–Ω–∏–µ

**–î–≤—É—Ö—ç—Ç–∞–ø–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞:**

```
–≠–¢–ê–ü 1: –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ñ–æ—Ä–º—ã
‚îú‚îÄ‚îÄ –§–æ—Ç–æ —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ –±—Ä–∞—É–∑–µ—Ä–µ (File –æ–±—ä–µ–∫—Ç—ã)
‚îú‚îÄ‚îÄ –ü—Ä–µ–≤—å—é –≥–µ–Ω–µ—Ä–∏—Ä—É—é—Ç—Å—è –Ω–∞ –∫–ª–∏–µ–Ω—Ç–µ
‚îú‚îÄ‚îÄ –û–ø–µ—Ä–∞—Ü–∏–∏ (add/remove/reorder) - –º–≥–Ω–æ–≤–µ–Ω–Ω—ã–µ
‚îî‚îÄ‚îÄ –°–µ—Ä–≤–µ—Ä –ù–ï –∑–∞–¥–µ–π—Å—Ç–≤–æ–≤–∞–Ω

–≠–¢–ê–ü 2: –û—Ç–ø—Ä–∞–≤–∫–∞ —Ñ–æ—Ä–º—ã
‚îú‚îÄ‚îÄ –í—Å–µ —Ñ–æ—Ç–æ –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä
‚îú‚îÄ‚îÄ –°–æ–∑–¥–∞—ë—Ç—Å—è –æ–±—ä—è–≤–ª–µ–Ω–∏–µ –≤ —Å—Ç–∞—Ç—É—Å–µ "processing"
‚îú‚îÄ‚îÄ –§–æ—Ç–æ —Å—Ç–∞–≤—è—Ç—Å—è –≤ –æ—á–µ—Ä–µ–¥—å –æ–±—Ä–∞–±–æ—Ç–∫–∏
‚îî‚îÄ‚îÄ WebSocket —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏
```

### –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å useBulkUpload

| –•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∞ | useBulkUpload | useFormMedia |
|----------------|---------------|--------------|
| –°—Ü–µ–Ω–∞—Ä–∏–π | MediaLibrary (–∞–¥–º–∏–Ω) | –§–æ—Ä–º–∞ –æ–±—ä—è–≤–ª–µ–Ω–∏—è (–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å) |
| –ö–æ–≥–¥–∞ –∑–∞–≥—Ä—É–∂–∞–µ—Ç | –°—Ä–∞–∑—É –ø—Ä–∏ –≤—ã–±–æ—Ä–µ | –ü—Ä–∏ submit —Ñ–æ—Ä–º—ã |
| –•—Ä–∞–Ω–µ–Ω–∏–µ –¥–æ –∑–∞–≥—Ä—É–∑–∫–∏ | - | Browser memory / IndexedDB |
| –û–±—Ä–∞–±–æ—Ç–∫–∞ | Async (–æ—á–µ—Ä–µ–¥—å) | Async –ø–æ—Å–ª–µ submit |
| Drag & Drop reorder | –ù–µ—Ç | –î–∞ |
| Crop/Edit –Ω–∞ –∫–ª–∏–µ–Ω—Ç–µ | –ù–µ—Ç | –î–∞ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) |

---

## ‚è±Ô∏è –°—Ä–æ–∫–∏

- **–ù–∞—á–∞–ª–æ:** –ü–æ—Å–ª–µ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏ UI —Ñ–æ—Ä–º –æ–±—ä—è–≤–ª–µ–Ω–∏–π
- **–ü–ª–∞–Ω–∏—Ä—É–µ–º–æ–µ –æ–∫–æ–Ω—á–∞–Ω–∏–µ:** TBD (–∫–æ–≥–¥–∞ UI –≥–æ—Ç–æ–≤ + 3-5 –¥–Ω–µ–π)
- **–§–∞–∫—Ç–∏—á–µ—Å–∫–æ–µ –æ–∫–æ–Ω—á–∞–Ω–∏–µ:** -

---

## üìä –≠—Ç–∞–ø—ã —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

### –≠—Ç–∞–ø 1: –ë–∞–∑–æ–≤–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ö—É–∫–∞

**–¶–µ–ª—å:** –°–æ–∑–¥–∞—Ç—å –æ—Å–Ω–æ–≤—É —Ö—É–∫–∞ —Å —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ–º —Ñ–∞–π–ª–∞–º–∏ –≤ –ø–∞–º—è—Ç–∏

**–ó–∞–¥–∞—á–∏:**

- [ ] –°–æ–∑–¥–∞—Ç—å —Ñ–∞–π–ª `src/hooks/useFormMedia.ts`
- [ ] –û–ø—Ä–µ–¥–µ–ª–∏—Ç—å –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã: `FormMediaFile`, `UseFormMediaOptions`, `UseFormMediaReturn`
- [ ] –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –±–∞–∑–æ–≤—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏: `addFiles`, `removeFile`, `clearAll`
- [ ] –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –≥–µ–Ω–µ—Ä–∞—Ü–∏—é –ø—Ä–µ–≤—å—é —á–µ—Ä–µ–∑ `URL.createObjectURL()`
- [ ] –î–æ–±–∞–≤–∏—Ç—å –≤–∞–ª–∏–¥–∞—Ü–∏—é: maxFiles, maxFileSize, allowedTypes
- [ ] –î–æ–±–∞–≤–∏—Ç—å cleanup –ø—Ä–∏ unmount

**–ö—Ä–∏—Ç–µ—Ä–∏–∏ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è:**

- [ ] –•—É–∫ —Å–æ–∑–¥–∞–Ω –∏ —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω
- [ ] –ú–æ–∂–Ω–æ –¥–æ–±–∞–≤–ª—è—Ç—å/—É–¥–∞–ª—è—Ç—å —Ñ–∞–π–ª—ã
- [ ] –ü—Ä–µ–≤—å—é –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è –º–≥–Ω–æ–≤–µ–Ω–Ω–æ
- [ ] Memory leaks –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç

**–û—Ü–µ–Ω–∫–∞ –≤—Ä–µ–º–µ–Ω–∏:** 4 —á–∞—Å–∞

**–ö–æ–¥:**

```typescript
// src/hooks/useFormMedia.ts

export interface FormMediaFile {
  id: string
  file: File
  preview: string
  position: number
  status: 'local' | 'uploading' | 'uploaded' | 'error'
  progress: number
  mediaId?: string
  error?: string
}

export interface UseFormMediaOptions {
  maxFiles?: number           // default: 10
  maxFileSize?: number        // default: 15MB
  allowedTypes?: string[]     // default: ['image/*']
  generatePreviews?: boolean  // default: true
  onValidationError?: (error: string) => void
}

export interface UseFormMediaReturn {
  files: FormMediaFile[]
  
  // –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ñ–∞–π–ª–∞–º–∏ (–ª–æ–∫–∞–ª—å–Ω–æ)
  addFiles: (files: File[]) => void
  removeFile: (id: string) => void
  reorderFiles: (fromIndex: number, toIndex: number) => void
  clearAll: () => void
  
  // –ó–∞–≥—Ä—É–∑–∫–∞ –Ω–∞ —Å–µ—Ä–≤–µ—Ä
  uploadAll: (entityType: string, entityId?: string) => Promise<UploadResult>
  isUploading: boolean
  uploadProgress: number
  
  // –°–æ—Å—Ç–æ—è–Ω–∏–µ
  hasChanges: boolean
  canSubmit: boolean
  validationErrors: string[]
}
```

---

### –≠—Ç–∞–ø 2: Drag & Drop –∏ Reorder

**–¶–µ–ª—å:** –î–æ–±–∞–≤–∏—Ç—å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è –ø–æ—Ä—è–¥–∫–∞ —Ñ–æ—Ç–æ

**–ó–∞–¥–∞—á–∏:**

- [ ] –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å `reorderFiles(fromIndex, toIndex)` 
- [ ] –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ `position` —É –≤—Å–µ—Ö —Ñ–∞–π–ª–æ–≤
- [ ] –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å react-beautiful-dnd –∏–ª–∏ dnd-kit (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
- [ ] –ü–æ–¥–¥–µ—Ä–∂–∫–∞ touch-—É—Å—Ç—Ä–æ–π—Å—Ç–≤

**–ö—Ä–∏—Ç–µ—Ä–∏–∏ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è:**

- [ ] –ü–æ—Ä—è–¥–æ–∫ —Ñ–∞–π–ª–æ–≤ –º–æ–∂–Ω–æ –º–µ–Ω—è—Ç—å
- [ ] `position` –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è
- [ ] –†–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ –º–æ–±–∏–ª—å–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞—Ö

**–û—Ü–µ–Ω–∫–∞ –≤—Ä–µ–º–µ–Ω–∏:** 2 —á–∞—Å–∞

---

### –≠—Ç–∞–ø 3: –ó–∞–≥—Ä—É–∑–∫–∞ –Ω–∞ —Å–µ—Ä–≤–µ—Ä

**–¶–µ–ª—å:** –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –º–∞—Å—Å–æ–≤—É—é –∑–∞–≥—Ä—É–∑–∫—É –ø—Ä–∏ submit —Ñ–æ—Ä–º—ã

**–ó–∞–¥–∞—á–∏:**

- [ ] –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å `uploadAll()` - –∑–∞–≥—Ä—É–∑–∫–∞ –≤—Å–µ—Ö —Ñ–∞–π–ª–æ–≤
- [ ] –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `/api/admin/media/upload-async` endpoint
- [ ] –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ —Å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ–º (3-5 –ø–æ—Ç–æ–∫–æ–≤)
- [ ] –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞ –∫–∞–∂–¥–æ–≥–æ —Ñ–∞–π–ª–∞
- [ ] –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ —Å retry
- [ ] –í–æ–∑–≤—Ä–∞—Ç –º–∞—Å—Å–∏–≤–∞ mediaId –¥–ª—è –ø—Ä–∏–≤—è–∑–∫–∏ –∫ –æ–±—ä—è–≤–ª–µ–Ω–∏—é

**–ö—Ä–∏—Ç–µ—Ä–∏–∏ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è:**

- [ ] –í—Å–µ —Ñ–∞–π–ª—ã –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –ø—Ä–∏ –≤—ã–∑–æ–≤–µ `uploadAll()`
- [ ] –ü—Ä–æ–≥—Ä–µ—Å—Å –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è
- [ ] –û—à–∏–±–∫–∏ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç—Å—è
- [ ] –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è —Å–ø–∏—Å–æ–∫ mediaId

**–û—Ü–µ–Ω–∫–∞ –≤—Ä–µ–º–µ–Ω–∏:** 4 —á–∞—Å–∞

**–ö–æ–¥:**

```typescript
// –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–µ —Ñ–æ—Ä–º—ã –æ–±—ä—è–≤–ª–µ–Ω–∏—è
const CreateListingForm = () => {
  const formMedia = useFormMedia({
    maxFiles: 10,
    maxFileSize: 15 * 1024 * 1024,
  })
  
  const handleSubmit = async (formData: ListingFormData) => {
    // 1. –ó–∞–≥—Ä—É–∂–∞–µ–º –≤—Å–µ —Ñ–æ—Ç–æ
    const uploadResult = await formMedia.uploadAll('listing')
    
    if (!uploadResult.success) {
      toast.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Ñ–æ—Ç–æ')
      return
    }
    
    // 2. –°–æ–∑–¥–∞—ë–º –æ–±—ä—è–≤–ª–µ–Ω–∏–µ —Å –ø—Ä–∏–≤—è–∑–∫–æ–π –∫ mediaId
    await createListing({
      ...formData,
      mediaIds: uploadResult.mediaIds,
    })
  }
  
  return (
    <form onSubmit={handleSubmit}>
      {/* Dropzone –¥–ª—è –≤—ã–±–æ—Ä–∞ —Ñ–æ—Ç–æ */}
      <MediaDropzone onDrop={formMedia.addFiles} />
      
      {/* –°–ø–∏—Å–æ–∫ —Ñ–æ—Ç–æ —Å –ø—Ä–µ–≤—å—é –∏ drag-and-drop */}
      <MediaPreviewList
        files={formMedia.files}
        onRemove={formMedia.removeFile}
        onReorder={formMedia.reorderFiles}
      />
      
      {/* –ü—Ä–æ–≥—Ä–µ—Å—Å –∑–∞–≥—Ä—É–∑–∫–∏ */}
      {formMedia.isUploading && (
        <UploadProgress progress={formMedia.uploadProgress} />
      )}
      
      <Button 
        type="submit" 
        disabled={!formMedia.canSubmit || formMedia.isUploading}
      >
        –û–ø—É–±–ª–∏–∫–æ–≤–∞—Ç—å
      </Button>
    </form>
  )
}
```

---

### –≠—Ç–∞–ø 4: IndexedDB –¥–ª—è –±–æ–ª—å—à–∏—Ö —Ñ–∞–π–ª–æ–≤ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

**–¶–µ–ª—å:** –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –±–æ–ª—å—à–∏—Ö —Ñ–∞–π–ª–æ–≤ –∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –º–µ–∂–¥—É —Å–µ—Å—Å–∏—è–º–∏

**–ó–∞–¥–∞—á–∏:**

- [ ] –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å IndexedDB (idb-keyval –∏–ª–∏ dexie)
- [ ] –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ñ–∞–π–ª–æ–≤ –ø—Ä–∏ –∑–∞–∫—Ä—ã—Ç–∏–∏ –≤–∫–ª–∞–¥–∫–∏
- [ ] –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–∏ –≤–æ–∑–≤—Ä–∞—Ç–µ –∫ —Ñ–æ—Ä–º–µ
- [ ] –ê–≤—Ç–æ–æ—á–∏—Å—Ç–∫–∞ —Å—Ç–∞—Ä—ã—Ö –¥–∞–Ω–Ω—ã—Ö (TTL: 24 —á–∞—Å–∞)
- [ ] –û–ø—Ü–∏—è `persistToIndexedDB: true`

**–ö—Ä–∏—Ç–µ—Ä–∏–∏ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è:**

- [ ] –§–∞–π–ª—ã —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –º–µ–∂–¥—É —Å–µ—Å—Å–∏—è–º–∏
- [ ] –ê–≤—Ç–æ–æ—á–∏—Å—Ç–∫–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç
- [ ] –ù–µ—Ç —É—Ç–µ—á–µ–∫ –ø–∞–º—è—Ç–∏

**–û—Ü–µ–Ω–∫–∞ –≤—Ä–µ–º–µ–Ω–∏:** 4 —á–∞—Å–∞

---

### –≠—Ç–∞–ø 5: –ö–æ–º–ø–æ–Ω–µ–Ω—Ç UI

**–¶–µ–ª—å:** –°–æ–∑–¥–∞—Ç—å –≥–æ—Ç–æ–≤—ã–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –¥–ª—è —Ñ–æ—Ä–º

**–ó–∞–¥–∞—á–∏:**

- [ ] –°–æ–∑–¥–∞—Ç—å `FormMediaUploader` –∫–æ–º–ø–æ–Ω–µ–Ω—Ç
- [ ] Dropzone —Å drag-and-drop –∑–∞–≥—Ä—É–∑–∫–æ–π
- [ ] Grid –ø—Ä–µ–≤—å—é —Å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å—é —É–¥–∞–ª–µ–Ω–∏—è
- [ ] Drag-and-drop —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –ø—Ä–µ–≤—å—é
- [ ] –ò–Ω–¥–∏–∫–∞—Ü–∏—è –æ—à–∏–±–æ–∫ –≤–∞–ª–∏–¥–∞—Ü–∏–∏
- [ ] –ê–¥–∞–ø—Ç–∏–≤–Ω—ã–π –¥–∏–∑–∞–π–Ω (mobile-first)
- [ ] –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å react-hook-form (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

**–ö—Ä–∏—Ç–µ—Ä–∏–∏ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è:**

- [ ] –ö–æ–º–ø–æ–Ω–µ–Ω—Ç –≥–æ—Ç–æ–≤ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é
- [ ] –°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –¥–∏–∑–∞–π–Ω-—Å–∏—Å—Ç–µ–º–µ Materio
- [ ] –†–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ –≤—Å–µ—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞—Ö

**–û—Ü–µ–Ω–∫–∞ –≤—Ä–µ–º–µ–Ω–∏:** 6 —á–∞—Å–æ–≤

**–ö–æ–¥:**

```typescript
// src/components/media/FormMediaUploader.tsx

interface FormMediaUploaderProps {
  value?: FormMediaFile[]
  onChange?: (files: FormMediaFile[]) => void
  maxFiles?: number
  maxFileSize?: number
  disabled?: boolean
  error?: string
  helperText?: string
}

const FormMediaUploader: React.FC<FormMediaUploaderProps> = (props) => {
  const formMedia = useFormMedia({
    maxFiles: props.maxFiles,
    maxFileSize: props.maxFileSize,
  })
  
  // Sync with form
  useEffect(() => {
    props.onChange?.(formMedia.files)
  }, [formMedia.files])
  
  return (
    <Box>
      {/* Dropzone */}
      <Dropzone onDrop={formMedia.addFiles} disabled={props.disabled}>
        <Typography>–ü–µ—Ä–µ—Ç–∞—â–∏—Ç–µ —Ñ–æ—Ç–æ –∏–ª–∏ –Ω–∞–∂–º–∏—Ç–µ –¥–ª—è –≤—ã–±–æ—Ä–∞</Typography>
      </Dropzone>
      
      {/* Preview Grid with DnD */}
      <DndContext onDragEnd={handleDragEnd}>
        <SortableContext items={formMedia.files.map(f => f.id)}>
          <Grid container spacing={1}>
            {formMedia.files.map((file, index) => (
              <SortableMediaItem
                key={file.id}
                file={file}
                onRemove={() => formMedia.removeFile(file.id)}
              />
            ))}
          </Grid>
        </SortableContext>
      </DndContext>
      
      {/* Validation errors */}
      {props.error && <FormHelperText error>{props.error}</FormHelperText>}
    </Box>
  )
}
```

---

### –≠—Ç–∞–ø 6: –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

**–¶–µ–ª—å:** –ü–æ–ª–Ω–æ–µ –ø–æ–∫—Ä—ã—Ç–∏–µ —Ç–µ—Å—Ç–∞–º–∏

**–ó–∞–¥–∞—á–∏:**

- [ ] Unit —Ç–µ—Å—Ç—ã –¥–ª—è useFormMedia
- [ ] Unit —Ç–µ—Å—Ç—ã –¥–ª—è FormMediaUploader
- [ ] Integration —Ç–µ—Å—Ç—ã —Å —Ñ–æ—Ä–º–æ–π
- [ ] E2E —Ç–µ—Å—Ç—ã —Å—Ü–µ–Ω–∞—Ä–∏—è —Å–æ–∑–¥–∞–Ω–∏—è –æ–±—ä—è–≤–ª–µ–Ω–∏—è
- [ ] –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞ –º–æ–±–∏–ª—å–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞—Ö

**–ö—Ä–∏—Ç–µ—Ä–∏–∏ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è:**

- [ ] –ü–æ–∫—Ä—ã—Ç–∏–µ —Ç–µ—Å—Ç–∞–º–∏ ‚â• 80%
- [ ] –í—Å–µ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –ø—É—Ç–∏ –ø–æ–∫—Ä—ã—Ç—ã
- [ ] E2E —Ç–µ—Å—Ç—ã –ø—Ä–æ—Ö–æ–¥—è—Ç

**–û—Ü–µ–Ω–∫–∞ –≤—Ä–µ–º–µ–Ω–∏:** 4 —á–∞—Å–∞

---

### –≠—Ç–∞–ø 7: –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

**–¶–µ–ª—å:** –î–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

**–ó–∞–¥–∞—á–∏:**

- [ ] JSDoc –¥–ª—è –≤—Å–µ—Ö —ç–∫—Å–ø–æ—Ä—Ç–æ–≤
- [ ] README —Å –ø—Ä–∏–º–µ—Ä–∞–º–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
- [ ] Storybook stories –¥–ª—è –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞
- [ ] –û–±–Ω–æ–≤–∏—Ç—å docs/api/ –µ—Å–ª–∏ –Ω—É–∂–Ω–æ

**–ö—Ä–∏—Ç–µ—Ä–∏–∏ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è:**

- [ ] –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø–æ–ª–Ω–∞—è
- [ ] –ü—Ä–∏–º–µ—Ä—ã —Ä–∞–±–æ—Ç–∞—é—Ç

**–û—Ü–µ–Ω–∫–∞ –≤—Ä–µ–º–µ–Ω–∏:** 2 —á–∞—Å–∞

---

## üìà –ü—Ä–æ–≥—Ä–µ—Å—Å

- **–í—ã–ø–æ–ª–Ω–µ–Ω–æ:** 0%
- **–û—Å—Ç–∞–ª–æ—Å—å:** 100%
- **–¢–µ–∫—É—â–∏–π —ç—Ç–∞–ø:** –ü–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ

**–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ:** 2025-11-28 - –ü–ª–∞–Ω —Å–æ–∑–¥–∞–Ω, –æ–∂–∏–¥–∞–Ω–∏–µ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏ UI —Ñ–æ—Ä–º –æ–±—ä—è–≤–ª–µ–Ω–∏–π

---

## ‚ö†Ô∏è –†–∏—Å–∫–∏ –∏ –º–∏—Ç–∏–≥–∞—Ü–∏—è

### 1. –ü–æ—Ç–µ—Ä—è –¥–∞–Ω–Ω—ã—Ö –ø—Ä–∏ –∑–∞–∫—Ä—ã—Ç–∏–∏ –≤–∫–ª–∞–¥–∫–∏

- **–û–ø–∏—Å–∞–Ω–∏–µ:** –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–∂–µ—Ç —Å–ª—É—á–∞–π–Ω–æ –∑–∞–∫—Ä—ã—Ç—å –≤–∫–ª–∞–¥–∫—É
- **–í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å:** –°—Ä–µ–¥–Ω—è—è
- **–í–ª–∏—è–Ω–∏–µ:** –°—Ä–µ–¥–Ω–µ–µ
- **–ú–∏—Ç–∏–≥–∞—Ü–∏—è:** 
  - beforeunload –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ –µ—Å–ª–∏ –µ—Å—Ç—å –Ω–µ—Å–æ—Ö—Ä–∞–Ω—ë–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã
  - IndexedDB persistence (–≠—Ç–∞–ø 4)

### 2. –ë–æ–ª—å—à–∏–µ —Ñ–∞–π–ª—ã –∑–∞–Ω–∏–º–∞—é—Ç –º–Ω–æ–≥–æ –ø–∞–º—è—Ç–∏

- **–û–ø–∏—Å–∞–Ω–∏–µ:** 10 —Ñ–æ—Ç–æ –ø–æ 15MB = 150MB –≤ –ø–∞–º—è—Ç–∏
- **–í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å:** –ù–∏–∑–∫–∞—è
- **–í–ª–∏—è–Ω–∏–µ:** –°—Ä–µ–¥–Ω–µ–µ
- **–ú–∏—Ç–∏–≥–∞—Ü–∏—è:**
  - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å IndexedDB –¥–ª—è —Ñ–∞–π–ª–æ–≤ > 5MB
  - –ü–æ–∫–∞–∑—ã–≤–∞—Ç—å –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ –ø—Ä–∏ –ø—Ä–µ–≤—ã—à–µ–Ω–∏–∏ –ª–∏–º–∏—Ç–∞

### 3. –ú–µ–¥–ª–µ–Ω–Ω–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –ø—Ä–µ–≤—å—é

- **–û–ø–∏—Å–∞–Ω–∏–µ:** –ë–æ–ª—å—à–∏–µ —Ñ–æ—Ç–æ –¥–æ–ª–≥–æ –∫–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É—é—Ç—Å—è
- **–í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å:** –ù–∏–∑–∫–∞—è
- **–í–ª–∏—è–Ω–∏–µ:** –ù–∏–∑–∫–æ–µ
- **–ú–∏—Ç–∏–≥–∞—Ü–∏—è:**
  - –ì–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å —É–º–µ–Ω—å—à–µ–Ω–Ω—ã–µ –ø—Ä–µ–≤—å—é (thumbnail)
  - Web Workers –¥–ª—è —Ñ–æ–Ω–æ–≤–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏

---

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –ü–ª–∞–Ω —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:

- [ ] Unit —Ç–µ—Å—Ç—ã (useFormMedia)
- [ ] Unit —Ç–µ—Å—Ç—ã (FormMediaUploader)
- [ ] Integration —Ç–µ—Å—Ç—ã
- [ ] E2E —Ç–µ—Å—Ç—ã
- [ ] –†—É—á–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –ö—Ä–∏—Ç–µ—Ä–∏–∏ –ø—Ä–∏–µ–º–∫–∏:

- [ ] –§–∞–π–ª—ã —Ö—Ä–∞–Ω—è—Ç—Å—è —Ç–æ–ª—å–∫–æ –≤ –±—Ä–∞—É–∑–µ—Ä–µ –¥–æ submit
- [ ] –ü—Ä–µ–≤—å—é –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è –º–≥–Ω–æ–≤–µ–Ω–Ω–æ
- [ ] Drag-and-drop —Ä–∞–±–æ—Ç–∞–µ—Ç
- [ ] –ó–∞–≥—Ä—É–∑–∫–∞ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç —Ç–æ–ª—å–∫–æ –ø—Ä–∏ submit
- [ ] –û—à–∏–±–∫–∏ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
- [ ] –†–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ –º–æ–±–∏–ª—å–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞—Ö

---

## üìö –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

### –ß—Ç–æ –Ω—É–∂–Ω–æ –∑–∞–¥–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å:

- [ ] API —Ö—É–∫–∞ useFormMedia
- [ ] Props –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞ FormMediaUploader
- [ ] –ü—Ä–∏–º–µ—Ä—ã –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å react-hook-form
- [ ] –ü—Ä–∏–º–µ—Ä—ã –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å —Ñ–æ—Ä–º–æ–π –æ–±—ä—è–≤–ª–µ–Ω–∏—è

---

## ‚úÖ –ß–µ–∫-–ª–∏—Å—Ç –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è

- [ ] –í—Å–µ —ç—Ç–∞–ø—ã –≤—ã–ø–æ–ª–Ω–µ–Ω—ã
- [ ] –í—Å–µ —Ç–µ—Å—Ç—ã –ø—Ä–æ–π–¥–µ–Ω—ã
- [ ] –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∞
- [ ] –û—Ç—á–µ—Ç —Å–æ–∑–¥–∞–Ω
- [ ] –°—Ç–∞—Ç—É—Å –æ–±–Ω–æ–≤–ª–µ–Ω –≤ STATUS_INDEX.md

---

## üìù –ü—Ä–∏–º–µ—á–∞–Ω–∏—è

### –û—Ç–ª–∏—á–∏–µ –æ—Ç useBulkUpload

`useBulkUpload` - –¥–ª—è MediaLibrary (–∞–¥–º–∏–Ω):
- –ó–∞–≥—Ä—É–∂–∞–µ—Ç —Ñ–∞–π–ª—ã —Å—Ä–∞–∑—É
- Async –æ–±—Ä–∞–±–æ—Ç–∫–∞ –≤ –æ—á–µ—Ä–µ–¥–∏
- –î–ª—è –º–∞—Å—Å–æ–≤–æ–π –∑–∞–≥—Ä—É–∑–∫–∏ –≤ –º–µ–¥–∏–∞—Ç–µ–∫—É

`useFormMedia` - –¥–ª—è —Ñ–æ—Ä–º –æ–±—ä—è–≤–ª–µ–Ω–∏–π (–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å):
- –•—Ä–∞–Ω–∏—Ç —Ñ–∞–π–ª—ã –≤ –±—Ä–∞—É–∑–µ—Ä–µ
- –ó–∞–≥—Ä—É–∂–∞–µ—Ç —Ç–æ–ª—å–∫–æ –ø—Ä–∏ submit —Ñ–æ—Ä–º—ã
- –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω –¥–ª—è UX —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

### –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏

- **react-dropzone** - –¥–ª—è drag-and-drop –∑–∞–≥—Ä—É–∑–∫–∏
- **@dnd-kit/core** - –¥–ª—è —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏ —Ñ–∞–π–ª–æ–≤
- **idb-keyval** - –¥–ª—è IndexedDB persistence
- **browser-image-compression** - –¥–ª—è —Å–∂–∞—Ç–∏—è –Ω–∞ –∫–ª–∏–µ–Ω—Ç–µ

### –ë—É–¥—É—â–∏–µ —É–ª—É—á—à–µ–Ω–∏—è

- Crop/rotate –Ω–∞ –∫–ª–∏–µ–Ω—Ç–µ –ø–µ—Ä–µ–¥ –∑–∞–≥—Ä—É–∑–∫–æ–π
- –°–∂–∞—Ç–∏–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –Ω–∞ –∫–ª–∏–µ–Ω—Ç–µ
- –ó–∞–≥—Ä—É–∑–∫–∞ —Å –∫–∞–º–µ—Ä—ã (mobile)
- AI-–∞–≤—Ç–æ—Ç–µ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–µ–≤—å—é

---

## üîó –°–≤—è–∑–∞–Ω–Ω—ã–µ –∑–∞–¥–∞—á–∏

- [ ] UI —Ñ–æ—Ä–º—ã —Å–æ–∑–¥–∞–Ω–∏—è –æ–±—ä—è–≤–ª–µ–Ω–∏—è
- [ ] API —Å–æ–∑–¥–∞–Ω–∏—è –æ–±—ä—è–≤–ª–µ–Ω–∏—è —Å mediaIds
- [ ] WebSocket —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏ —Ñ–æ—Ç–æ

---

## –ò—Å—Ç–æ—Ä–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π

- **2025-11-28:** –°–æ–∑–¥–∞–Ω –ø–ª–∞–Ω –º–æ–¥—É–ª—è useFormMedia




