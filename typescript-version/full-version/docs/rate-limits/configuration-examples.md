# –ü—Ä–∏–º–µ—Ä—ã –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ Rate Limit

–î–æ–∫—É–º–µ–Ω—Ç —Å–æ–¥–µ—Ä–∂–∏—Ç –ø—Ä–∏–º–µ—Ä—ã –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –¥–ª—è —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è rate limiting.

## üìã –û–±—â–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏

```typescript
{
  module: string // –ò–º—è –º–æ–¥—É–ª—è (auth, chat, upload, etc.)
  maxRequests: number // –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–ø—Ä–æ—Å–æ–≤
  windowMs: number // –û–∫–Ω–æ –≤—Ä–µ–º–µ–Ω–∏ –≤ –º–∏–ª–ª–∏—Å–µ–∫—É–Ω–¥–∞—Ö
  blockMs: number // –î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ –≤ –º–∏–ª–ª–∏—Å–µ–∫—É–Ω–¥–∞—Ö
  warnThreshold: number // –ü–æ—Ä–æ–≥ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è (–æ—Å—Ç–∞–ª–æ—Å—å –∑–∞–ø—Ä–æ—Å–æ–≤)
  mode: 'enforce' | 'monitor' // –†–µ–∂–∏–º —Ä–∞–±–æ—Ç—ã
  isActive: boolean // –ê–∫—Ç–∏–≤–µ–Ω –ª–∏ –º–æ–¥—É–ª—å
  storeEmailInEvents: boolean // –°–æ—Ö—Ä–∞–Ω—è—Ç—å email –≤ —Å–æ–±—ã—Ç–∏—è—Ö (GDPR)
  storeIpInEvents: boolean // –°–æ—Ö—Ä–∞–Ω—è—Ç—å IP –≤ —Å–æ–±—ã—Ç–∏—è—Ö (GDPR)
}
```

## üîê –°—Ü–µ–Ω–∞—Ä–∏–π 1 - –ó–∞—â–∏—Ç–∞ –æ—Ç –±—Ä—É—Ç—Ñ–æ—Ä—Å–∞ (Authentication)

**–¶–µ–ª—å:** –ó–∞—â–∏—Ç–∞ –æ—Ç –ø–æ–¥–±–æ—Ä–∞ –ø–∞—Ä–æ–ª–µ–π –∏ –∞—Ç–∞–∫ –Ω–∞ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—é.

```json
{
  "module": "auth",
  "maxRequests": 5,
  "windowMs": 900000,
  "blockMs": 3600000,
  "warnThreshold": 2,
  "mode": "enforce",
  "isActive": true,
  "storeEmailInEvents": false,
  "storeIpInEvents": false
}
```

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**

- `maxRequests: 5` ‚Äî 5 –ø–æ–ø—ã—Ç–æ–∫ –≤—Ö–æ–¥–∞
- `windowMs: 900000` ‚Äî –æ–∫–Ω–æ 15 –º–∏–Ω—É—Ç (900 —Å–µ–∫—É–Ω–¥)
- `blockMs: 3600000` ‚Äî –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –Ω–∞ 1 —á–∞—Å –ø—Ä–∏ –ø—Ä–µ–≤—ã—à–µ–Ω–∏–∏
- `warnThreshold: 2` ‚Äî –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ –ø—Ä–∏ 2 –æ—Å—Ç–∞–≤—à–∏—Ö—Å—è –ø–æ–ø—ã—Ç–∫–∞—Ö

**API –∑–∞–ø—Ä–æ—Å:**

```bash
curl -X PUT "http://localhost:3000/api/admin/rate-limits" \
  -H "Authorization: Bearer <token>" \
  -H "Content-Type: application/json" \
  -d '{
    "module": "auth",
    "maxRequests": 5,
    "windowMs": 900000,
    "blockMs": 3600000,
    "warnThreshold": 2,
    "mode": "enforce",
    "isActive": true
  }'
```

## üí¨ –°—Ü–µ–Ω–∞—Ä–∏–π 2 - –ó–∞—â–∏—Ç–∞ —á–∞—Ç–∞ –æ—Ç —Å–ø–∞–º–∞

**–¶–µ–ª—å:** –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏–µ —Å–ø–∞–º–∞ —Å–æ–æ–±—â–µ–Ω–∏–π –≤ —á–∞—Ç–µ.

```json
{
  "module": "chat-messages",
  "maxRequests": 10,
  "windowMs": 3600000,
  "blockMs": 900000,
  "warnThreshold": 3,
  "mode": "enforce",
  "isActive": true,
  "storeEmailInEvents": false,
  "storeIpInEvents": false
}
```

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**

- `maxRequests: 10` ‚Äî 10 —Å–æ–æ–±—â–µ–Ω–∏–π –≤ —á–∞—Å
- `windowMs: 3600000` ‚Äî –æ–∫–Ω–æ 1 —á–∞—Å
- `blockMs: 900000` ‚Äî –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –Ω–∞ 15 –º–∏–Ω—É—Ç
- `warnThreshold: 3` ‚Äî –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ –ø—Ä–∏ 3 –æ—Å—Ç–∞–≤—à–∏—Ö—Å—è —Å–æ–æ–±—â–µ–Ω–∏—è—Ö

## üì§ –°—Ü–µ–Ω–∞—Ä–∏–π 3 - –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –∑–∞–≥—Ä—É–∑–æ–∫ —Ñ–∞–π–ª–æ–≤

**–¶–µ–ª—å:** –ó–∞—â–∏—Ç–∞ –æ—Ç –∑–ª–æ—É–ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏—è —Ö—Ä–∞–Ω–∏–ª–∏—â–µ–º.

```json
{
  "module": "upload",
  "maxRequests": 20,
  "windowMs": 3600000,
  "blockMs": 1800000,
  "warnThreshold": 5,
  "mode": "enforce",
  "isActive": true,
  "storeEmailInEvents": false,
  "storeIpInEvents": false
}
```

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**

- `maxRequests: 20` ‚Äî 20 –∑–∞–≥—Ä—É–∑–æ–∫ –≤ —á–∞—Å
- `windowMs: 3600000` ‚Äî –æ–∫–Ω–æ 1 —á–∞—Å
- `blockMs: 1800000` ‚Äî –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –Ω–∞ 30 –º–∏–Ω—É—Ç
- `warnThreshold: 5` ‚Äî –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ –ø—Ä–∏ 5 –æ—Å—Ç–∞–≤—à–∏—Ö—Å—è –∑–∞–≥—Ä—É–∑–∫–∞—Ö

## üìß –°—Ü–µ–Ω–∞—Ä–∏–π 4 - –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –æ—Ç–ø—Ä–∞–≤–∫–∏ email

**–¶–µ–ª—å:** –ó–∞—â–∏—Ç–∞ –æ—Ç —Å–ø–∞–º–∞ —á–µ—Ä–µ–∑ email —Å–∏—Å—Ç–µ–º—É.

```json
{
  "module": "email",
  "maxRequests": 50,
  "windowMs": 3600000,
  "blockMs": 3600000,
  "warnThreshold": 10,
  "mode": "enforce",
  "isActive": true,
  "storeEmailInEvents": false,
  "storeIpInEvents": false
}
```

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**

- `maxRequests: 50` ‚Äî 50 –ø–∏—Å–µ–º –≤ —á–∞—Å
- `windowMs: 3600000` ‚Äî –æ–∫–Ω–æ 1 —á–∞—Å
- `blockMs: 3600000` ‚Äî –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –Ω–∞ 1 —á–∞—Å
- `warnThreshold: 10` ‚Äî –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ –ø—Ä–∏ 10 –æ—Å—Ç–∞–≤—à–∏—Ö—Å—è –ø–∏—Å—å–º–∞—Ö

## üîç –°—Ü–µ–Ω–∞—Ä–∏–π 5 - –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –±–µ–∑ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ (Monitor Mode)

**–¶–µ–ª—å:** –°–±–æ—Ä —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –ø–µ—Ä–µ–¥ –≤–∫–ª—é—á–µ–Ω–∏–µ–º —Å—Ç—Ä–æ–≥–æ–π –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏.

```json
{
  "module": "new-feature",
  "maxRequests": 10,
  "windowMs": 3600000,
  "blockMs": 1800000,
  "warnThreshold": 3,
  "mode": "monitor",
  "isActive": true,
  "storeEmailInEvents": false,
  "storeIpInEvents": false
}
```

**–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:**

- `mode: "monitor"` ‚Äî —Å–æ–±—ã—Ç–∏—è –ª–æ–≥–∏—Ä—É—é—Ç—Å—è, –Ω–æ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –Ω–µ –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–∏–¥–∏—Ç –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ, –Ω–æ –º–æ–∂–µ—Ç –ø—Ä–æ–¥–æ–ª–∂–∞—Ç—å —Ä–∞–±–æ—Ç—É
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

## üõ°Ô∏è –°—Ü–µ–Ω–∞—Ä–∏–π 6 - –°—Ç—Ä–æ–≥–∞—è –∑–∞—â–∏—Ç–∞ (High Security)

**–¶–µ–ª—å:** –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –∑–∞—â–∏—Ç–∞ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –æ–ø–µ—Ä–∞—Ü–∏–π.

```json
{
  "module": "admin-operations",
  "maxRequests": 3,
  "windowMs": 1800000,
  "blockMs": 7200000,
  "warnThreshold": 1,
  "mode": "enforce",
  "isActive": true,
  "storeEmailInEvents": true,
  "storeIpInEvents": true
}
```

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**

- `maxRequests: 3` ‚Äî —Ç–æ–ª—å–∫–æ 3 –ø–æ–ø—ã—Ç–∫–∏
- `windowMs: 1800000` ‚Äî –æ–∫–Ω–æ 30 –º–∏–Ω—É—Ç
- `blockMs: 7200000` ‚Äî –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –Ω–∞ 2 —á–∞—Å–∞
- `warnThreshold: 1` ‚Äî –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ –ø—Ä–∏ 1 –æ—Å—Ç–∞–≤—à–µ–π—Å—è –ø–æ–ø—ã—Ç–∫–µ
- `storeEmailInEvents: true` ‚Äî —Å–æ—Ö—Ä–∞–Ω—è—Ç—å email –¥–ª—è –∞—É–¥–∏—Ç–∞
- `storeIpInEvents: true` ‚Äî —Å–æ—Ö—Ä–∞–Ω—è—Ç—å IP –¥–ª—è –∞—É–¥–∏—Ç–∞

## üìä –°—Ü–µ–Ω–∞—Ä–∏–π 7 - –ú—è–≥–∫–æ–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ (User-Friendly)

**–¶–µ–ª—å:** –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –±–µ–∑ –∞–≥—Ä–µ—Å—Å–∏–≤–Ω–æ–π –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏.

```json
{
  "module": "api-requests",
  "maxRequests": 100,
  "windowMs": 3600000,
  "blockMs": 300000,
  "warnThreshold": 20,
  "mode": "enforce",
  "isActive": true,
  "storeEmailInEvents": false,
  "storeIpInEvents": false
}
```

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**

- `maxRequests: 100` ‚Äî 100 –∑–∞–ø—Ä–æ—Å–æ–≤ –≤ —á–∞—Å
- `windowMs: 3600000` ‚Äî –æ–∫–Ω–æ 1 —á–∞—Å
- `blockMs: 300000` ‚Äî –∫–æ—Ä–æ—Ç–∫–∞—è –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –Ω–∞ 5 –º–∏–Ω—É—Ç
- `warnThreshold: 20` ‚Äî —Ä–∞–Ω–Ω–µ–µ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ

## üîÑ –°—Ü–µ–Ω–∞—Ä–∏–π 8 - –ü–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ–µ —É–∂–µ—Å—Ç–æ—á–µ–Ω–∏–µ

**–°—Ç—Ä–∞—Ç–µ–≥–∏—è:** –ù–∞—á–∞—Ç—å —Å monitor mode, –∑–∞—Ç–µ–º –ø–µ—Ä–µ–π—Ç–∏ –Ω–∞ enforce.

**–≠—Ç–∞–ø 1: –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ (1 –Ω–µ–¥–µ–ª—è)**

```json
{
  "module": "new-endpoint",
  "maxRequests": 50,
  "windowMs": 3600000,
  "blockMs": 1800000,
  "warnThreshold": 10,
  "mode": "monitor",
  "isActive": true
}
```

**–≠—Ç–∞–ø 2: –ú—è–≥–∫–æ–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ (1 –Ω–µ–¥–µ–ª—è)**

```json
{
  "module": "new-endpoint",
  "maxRequests": 50,
  "windowMs": 3600000,
  "blockMs": 300000,
  "warnThreshold": 10,
  "mode": "enforce",
  "isActive": true
}
```

**–≠—Ç–∞–ø 3: –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ**

```json
{
  "module": "new-endpoint",
  "maxRequests": 30,
  "windowMs": 3600000,
  "blockMs": 900000,
  "warnThreshold": 5,
  "mode": "enforce",
  "isActive": true
}
```

## üìù –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –≤—ã–±–æ—Ä—É –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤

### maxRequests

- **–ù–∏–∑–∫–æ–µ (3-5):** –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ (auth, admin)
- **–°—Ä–µ–¥–Ω–µ–µ (10-50):** –û–±—ã—á–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ (chat, upload)
- **–í—ã—Å–æ–∫–æ–µ (50-100):** API –∑–∞–ø—Ä–æ—Å—ã, —á—Ç–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö

### windowMs

- **–ö–æ—Ä–æ—Ç–∫–æ–µ (15-30 –º–∏–Ω):** –ë—ã—Å—Ç—Ä—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏, –∑–∞—â–∏—Ç–∞ –æ—Ç –±—Ä—É—Ç—Ñ–æ—Ä—Å–∞
- **–°—Ä–µ–¥–Ω–µ–µ (1 —á–∞—Å):** –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏
- **–î–ª–∏–Ω–Ω–æ–µ (24 —á–∞—Å–∞):** –î–æ–ª–≥–æ—Å—Ä–æ—á–Ω—ã–µ –ª–∏–º–∏—Ç—ã

### blockMs

- **–ö–æ—Ä–æ—Ç–∫–æ–µ (5-15 –º–∏–Ω):** –ú—è–≥–∫–æ–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ, –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–∏
- **–°—Ä–µ–¥–Ω–µ–µ (30-60 –º–∏–Ω):** –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞—è –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞
- **–î–ª–∏–Ω–Ω–æ–µ (2+ —á–∞—Å–∞):** –°—Ç—Ä–æ–≥–∞—è –∑–∞—â–∏—Ç–∞, –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–∏

### warnThreshold

- **–ù–∏–∑–∫–æ–µ (1-2):** –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–∏
- **–°—Ä–µ–¥–Ω–µ–µ (3-5):** –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏
- **–í—ã—Å–æ–∫–æ–µ (10-20):** –ú—è–≥–∫–∏–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è

## üîí GDPR –∏ PII –∑–∞—â–∏—Ç–∞

–î–ª—è —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è GDPR —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è:

- `storeEmailInEvents: false` ‚Äî –Ω–µ —Å–æ—Ö—Ä–∞–Ω—è—Ç—å email –≤ —Å–æ–±—ã—Ç–∏—è—Ö
- `storeIpInEvents: false` ‚Äî –Ω–µ —Å–æ—Ö—Ä–∞–Ω—è—Ç—å IP –≤ —Å–æ–±—ã—Ç–∏—è—Ö

–ò—Å–∫–ª—é—á–µ–Ω–∏—è (—Ç–æ–ª—å–∫–æ –¥–ª—è –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –æ–ø–µ—Ä–∞—Ü–∏–π):

- –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏
- –û–ø–µ—Ä–∞—Ü–∏–∏ —Ç—Ä–µ–±—É—é—â–∏–µ –∞—É–¥–∏—Ç–∞
- –ó–∞—â–∏—Ç–∞ –æ—Ç —Å–µ—Ä—å–µ–∑–Ω—ã—Ö –∞—Ç–∞–∫

## üìö –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã

- [–û–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω—ã–π –≥–∞–π–¥](../monitoring/rate-limit-operations.md)
- [API –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è](../api/rate-limits.md)
- [–†–æ—Ç–∞—Ü–∏—è –∫–ª—é—á–µ–π —Ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è](./hash-key-rotation.md)
