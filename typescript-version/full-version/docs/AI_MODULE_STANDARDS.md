# Стандарты разработки модулей Materio Next.js

## Статус
- [ ] Планируется
- [x] В работе
- [ ] Завершено
- [ ] Отложено

## Приоритет
- Высокий

## Описание
Единый набор требований для создания новых модулей и доработки существующих в проекте Materio Next.js. Требования распространяются на любой функциональный блок (страницы, сервисы, API-слои, хелперы) и должны учитываться на этапах анализа, планирования, реализации и тестирования.

## Цели
- [ ] Обеспечить единое качество кода для всех модулей
- [ ] Снизить количество регрессий при доработках
- [ ] Гарантировать выполнение нефункциональных требований (безопасность, производительность, UX)
- [ ] Упростить ревью и сопровождение документации

## Требования
### Функциональные
- [ ] Модуль должен соответствовать существующей архитектуре (`src/@core`, `src/services`, `src/app`) и использовать повторно доступные утилиты/хуки вместо дублирования логики.
- [ ] Интерфейсы и бизнес-правила модуля должны быть описаны в ТЗ и синхронизированы с документами `docs/api`, `docs/permissions`, `docs/navigation`, если модуль их затрагивает.
- [ ] Любой пользовательский функционал обязан поддерживать i18n (файлы `public/[lang]`) и соответствовать активным требованиям по доступности (aria-атрибуты, контраст, управление с клавиатуры).
- [ ] API-/сервисные изменения сопровождаются схемами типов (Prisma, Zod, DTO) и проверками входных данных, включая валидацию на клиенте и сервере.
- [ ] Все интеграции с внешними сервисами/шинами событий должны иметь явную политику повторных попыток, логирование и описанный failure mode.

### Нефункциональные
- [ ] Безопасность: соблюдение принципов из `docs/analysis/security` и `docs/permissions` (проверка прав доступа, защита от OWASP Top 10, отсутствие хранения PII в логе, шифрование чувствительных данных, маскирование токенов).
- [ ] Производительность: рендер без блокирующих операций на клиенте, отложенная загрузка тяжелых компонентов, использование кэшей (`react-query`, `redis`) при доступе к дорогим операциям, профилирование критических путей до SLA < 200мс на сервере и TTI < 2с на клиенте.
- [ ] Надёжность: обязательные метрики/трейсы (Prometheus/Grafana), структурированные логи, алерты для критичных ошибок, прохождение автоматических тестов (unit/integration/e2e) с покрытием, указанным в `docs/testing`.
- [ ] UX/UI: соответствие гайдлайнам Materio (адаптивность, консистентные компоненты из `src/components`, состояния загрузки/ошибки/пустых данных, отсутствие layout shift > 0.1).
- [ ] Документация: после внедрения обновить `docs/STATUS_INDEX.md`, соответствующие планы/анализы и описать модуль в релевантных разделах (`docs/development`, `docs/api`, `docs/navigation`).

## Критерии приемки
- [ ] Представлены и одобрены ТЗ + план реализации, связанные с модулем.
- [ ] Код прошёл ревью, линтеры, unit/integration/e2e тесты и проверку Lighthouse (для UI) или нагрузочные тесты (для backend).
- [ ] Конфигурации инфраструктуры и окружений (env, secrets, мониторинг) обновлены и задокументированы.
- [ ] Обновлены пользовательские и технические инструкции (changelog, README, onboarding, если требуется).

## Связанные документы
- [AI_WORKFLOW_GUIDE](AI_WORKFLOW_GUIDE.md)
- [DOCUMENTATION_STANDARDS](DOCUMENTATION_STANDARDS.md)
- [docs/testing/*](testing)
- [docs/analysis/security/*](analysis/security)

## История изменений
- 2025-11-24: Создано базовое требование для всех модулей проекта.

