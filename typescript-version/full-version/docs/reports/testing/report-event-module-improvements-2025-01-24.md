# –û—Ç—á–µ—Ç –æ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ —É–ª—É—á—à–µ–Ω–∏–π –º–æ–¥—É–ª—è Event

**–ü–µ—Ä–∏–æ–¥:** 2025-01-24  
**–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è:** 2025-01-24  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ó–∞–≤–µ—Ä—à–µ–Ω

---

## üìã –°–≤—è–∑–∞–Ω–Ω—ã–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã

- [–ü–ª–∞–Ω —É–ª—É—á—à–µ–Ω–∏–π –º–æ–¥—É–ª—è Event](plans/active/plan-event-module-improvements-2025-01-24.md)
- [–ê–Ω–∞–ª–∏–∑ –º–æ–¥—É–ª—è Event](analysis/architecture/analysis-event-module-2025-01-24.md)
- [–¢–ó: Events Technical Specification](requirements/completed/events-technical-specification.md)

---

## ‚úÖ –í—ã–ø–æ–ª–Ω–µ–Ω–æ

### –≠—Ç–∞–ø 1: Retention Policy ‚úÖ

**–î–∞—Ç–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è:** 2025-01-24

**–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ:**
1. ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω—ã env –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –¥–ª—è retention policy:
   - `EVENT_RETENTION_DEFAULT_DAYS` (90 –¥–Ω–µ–π)
   - `EVENT_RETENTION_RATE_LIMIT_DAYS` (30 –¥–Ω–µ–π)
   - `EVENT_RETENTION_AUTH_DAYS` (90 –¥–Ω–µ–π)
   - `EVENT_RETENTION_REGISTRATION_DAYS` (90 –¥–Ω–µ–π)
   - `EVENT_RETENTION_MODERATION_DAYS` (365 –¥–Ω–µ–π)
   - `EVENT_RETENTION_BLOCK_DAYS` (365 –¥–Ω–µ–π)
   - `EVENT_RETENTION_CHAT_DAYS` (90 –¥–Ω–µ–π)
   - `EVENT_RETENTION_ADS_DAYS` (90 –¥–Ω–µ–π)
   - `EVENT_RETENTION_NOTIFICATIONS_DAYS` (90 –¥–Ω–µ–π)
   - `EVENT_RETENTION_SYSTEM_DAYS` (90 –¥–Ω–µ–π)
   - `EVENT_RETENTION_BATCH_SIZE` (1000)
   - `EVENT_RETENTION_ENABLED` (true)

2. ‚úÖ –°–æ–∑–¥–∞–Ω `EventRetentionService`:
   - –ë–∞—Ç—á–µ–≤–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ —Å—Ç–∞—Ä—ã—Ö —Å–æ–±—ã—Ç–∏–π
   - –ü–æ–¥–¥–µ—Ä–∂–∫–∞ dry-run —Ä–µ–∂–∏–º–∞
   - –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –º–µ—Ç—Ä–∏–∫–∞–º–∏ Prometheus
   - –°—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

3. ‚úÖ –°–æ–∑–¥–∞–Ω API endpoint `/api/admin/events/retention`:
   - GET - –ø–æ–ª—É—á–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞ retention job
   - POST - –∑–∞–ø—É—Å–∫ cleanup –≤—Ä—É—á–Ω—É—é
   - –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞ (admin/superadmin)

4. ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω—ã –º–µ—Ç—Ä–∏–∫–∏:
   - `events_retention_deleted_total` - –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —É–¥–∞–ª–µ–Ω–Ω—ã—Ö —Å–æ–±—ã—Ç–∏–π
   - `events_retention_duration_seconds` - –≤—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è cleanup
   - `events_retention_errors_total` - –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ—à–∏–±–æ–∫

5. ‚úÖ –°–æ–∑–¥–∞–Ω–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è:
   - `docs/events/retention-policy.md` - –ø–æ–ª–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –ø–æ–ª–∏—Ç–∏–∫–∏ retention

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ—á–∏—Å—Ç–∫–∞ —Å—Ç–∞—Ä—ã—Ö —Å–æ–±—ã—Ç–∏–π —Ä–∞–±–æ—Ç–∞–µ—Ç, –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞—è –Ω–µ–æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω—ã–π —Ä–æ—Å—Ç –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö.

---

### –≠—Ç–∞–ø 2: –≠–∫—Å–ø–æ—Ä—Ç —Å–æ–±—ã—Ç–∏–π ‚úÖ

**–î–∞—Ç–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è:** 2025-01-24

**–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ:**
1. ‚úÖ –°–æ–∑–¥–∞–Ω API endpoint `/api/admin/events/export/[format]`:
   - –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Ñ–æ—Ä–º–∞—Ç–æ–≤: CSV –∏ JSON
   - –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –≤—Å–µ—Ö —Ñ–∏–ª—å—Ç—Ä–æ–≤ –∏–∑ GET `/api/admin/events`
   - –ú–∞—Å–∫–∏—Ä–æ–≤–∞–Ω–∏–µ PII –¥–∞–Ω–Ω—ã—Ö —Å–æ–≥–ª–∞—Å–Ω–æ –ø—Ä–∞–≤–∞–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
   - –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞ (`events.export`)
   - –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ —Ä–∞–∑–º–µ—Ä–∞: ‚â§10k –∑–∞–ø–∏—Å–µ–π –∏–ª–∏ ‚â§5 MB
   - –ó–∞–ø–∏—Å—å —Å–æ–±—ã—Ç–∏—è `system.export_performed` –ø–æ—Å–ª–µ —ç–∫—Å–ø–æ—Ä—Ç–∞

2. ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–∞ –∫–Ω–æ–ø–∫–∞ —ç–∫—Å–ø–æ—Ä—Ç–∞ –≤ UI:
   - –†–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∞ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ `/admin/events`
   - –í—ã–ø–∞–¥–∞—é—â–µ–µ –º–µ–Ω—é —Å –≤—ã–±–æ—Ä–æ–º —Ñ–æ—Ä–º–∞—Ç–∞ (CSV/JSON)
   - –ò—Å–ø–æ–ª—å–∑—É–µ—Ç —Ç–µ–∫—É—â–∏–µ —Ñ–∏–ª—å—Ç—Ä—ã —Å—Ç—Ä–∞–Ω–∏—Ü—ã
   - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–∫–∞—á–∏–≤–∞–Ω–∏–µ —Ñ–∞–π–ª–∞
   - –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä –∑–∞–≥—Ä—É–∑–∫–∏

3. ‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω–∞ API –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è:
   - `docs/api/events.md` - –æ–ø–∏—Å–∞–Ω–∏–µ endpoints —ç–∫—Å–ø–æ—Ä—Ç–∞
   - `docs/api/overview.md` - –¥–æ–±–∞–≤–ª–µ–Ω–∞ —Å—Å—ã–ª–∫–∞ –Ω–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é

4. ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω—ã E2E —Ç–µ—Å—Ç—ã:
   - –¢–µ—Å—Ç —ç–∫—Å–ø–æ—Ä—Ç–∞ –≤ CSV
   - –¢–µ—Å—Ç —ç–∫—Å–ø–æ—Ä—Ç–∞ –≤ JSON
   - –¢–µ—Å—Ç —Ñ–∏–ª—å—Ç—Ä–æ–≤ –ø—Ä–∏ —ç–∫—Å–ø–æ—Ä—Ç–µ
   - –¢–µ—Å—Ç –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞
   - –¢–µ—Å—Ç —ç–∫—Å–ø–æ—Ä—Ç–∞ –∏–∑ UI

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –≠–∫—Å–ø–æ—Ä—Ç —Å–æ–±—ã—Ç–∏–π –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω —Å–æ–≥–ª–∞—Å–Ω–æ –¢–ó, –≤–∫–ª—é—á–∞—è UI –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—é.

---

### –≠—Ç–∞–ø 3: –£–ª—É—á—à–µ–Ω–∏–µ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –æ—à–∏–±–æ–∫ ‚úÖ

**–î–∞—Ç–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è:** 2025-01-24

**–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ:**
1. ‚úÖ –£–ª—É—á—à–µ–Ω–∞ —Ñ—É–Ω–∫—Ü–∏—è `safeParseJson`:
   - –î–æ–±–∞–≤–ª–µ–Ω–æ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—à–∏–±–æ–∫
   - –ö–æ–Ω—Ç–µ–∫—Å—Ç–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è (field, eventId, source)
   - Preview –∑–Ω–∞—á–µ–Ω–∏—è –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏
   - –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –º–µ—Ç—Ä–∏–∫–∞–º–∏

2. ‚úÖ –£–ª—É—á—à–µ–Ω–∞ –≤–∞–ª–∏–¥–∞—Ü–∏—è severity:
   - –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–µ–≤–∞–ª–∏–¥–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π
   - –ü–æ–∫–∞–∑ –≤–∞–ª–∏–¥–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π –¥–ª—è —Å–ø—Ä–∞–≤–∫–∏
   - –ú–µ—Ç—Ä–∏–∫–∏ –¥–ª—è –Ω–µ–≤–∞–ª–∏–¥–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π

3. ‚úÖ –£–ª—É—á—à–µ–Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ –≤ API routes:
   - –î–µ—Ç–∞–ª—å–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —Å –∫–æ–Ω—Ç–µ–∫—Å—Ç–æ–º (URL, timestamp)
   - –†–∞–∑–Ω—ã–µ HTTP —Å—Ç–∞—Ç—É—Å—ã –¥–ª—è —Ä–∞–∑–Ω—ã—Ö —Ç–∏–ø–æ–≤ –æ—à–∏–±–æ–∫:
     - `503` –¥–ª—è –æ—à–∏–±–æ–∫ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ –ë–î
     - `403` –¥–ª—è –æ—à–∏–±–æ–∫ –¥–æ—Å—Ç—É–ø–∞
     - `500` –¥–ª—è –æ—Å—Ç–∞–ª—å–Ω—ã—Ö –æ—à–∏–±–æ–∫
   - –ü–æ–ª–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ–± –æ—à–∏–±–∫–µ (name, message, stack, cause)

4. ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω—ã –º–µ—Ç—Ä–∏–∫–∏ Prometheus:
   - `events_parsing_errors_total` - –æ—à–∏–±–∫–∏ –ø–∞—Ä—Å–∏–Ω–≥–∞ JSON (labels: field, source)
   - `events_invalid_severity_total` - –Ω–µ–≤–∞–ª–∏–¥–Ω—ã–µ severity (label: invalid_value)

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –í—Å–µ –æ—à–∏–±–∫–∏ –ª–æ–≥–∏—Ä—É—é—Ç—Å—è –∏ –æ—Ç—Å–ª–µ–∂–∏–≤–∞—é—Ç—Å—è —á–µ—Ä–µ–∑ –º–µ—Ç—Ä–∏–∫–∏, —É–ª—É—á—à–µ–Ω–∞ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –ø—Ä–æ–±–ª–µ–º.

---

### –≠—Ç–∞–ø 4: –£–Ω–∏—Ñ–∏–∫–∞—Ü–∏—è EventService ‚úÖ

**–î–∞—Ç–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è:** 2025-01-24

**–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ:**
1. ‚úÖ –ü–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω `EventService` –≤ `rate-limit` –º–æ–¥—É–ª–µ:
   - –°—Ç–∞—Ä–æ–µ –∏–º—è: `src/lib/rate-limit/services/EventService.ts`
   - –ù–æ–≤–æ–µ –∏–º—è: `src/lib/rate-limit/services/RateLimitEventRecorder.ts`
   - –û–±–Ω–æ–≤–ª–µ–Ω—ã –≤—Å–µ –∏–º–ø–æ—Ä—Ç—ã –∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
   - –û–±–Ω–æ–≤–ª–µ–Ω—ã —Ç–µ—Å—Ç—ã

2. ‚úÖ –£—Å—Ç—Ä–∞–Ω–µ–Ω –∫–æ–Ω—Ñ–ª–∏–∫—Ç –∏–º–µ–Ω:
   - –¢–µ–ø–µ—Ä—å –µ—Å—Ç—å –æ–¥–∏–Ω —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π `EventService` –≤ `src/services/events/EventService.ts`
   - –ò —Å–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π `RateLimitEventRecorder` –¥–ª—è rate-limit —Å–æ–±—ã—Ç–∏–π

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –ö–æ–Ω—Ñ–ª–∏–∫—Ç –∏–º–µ–Ω —É—Å—Ç—Ä–∞–Ω–µ–Ω, –∫–æ–¥ —Å—Ç–∞–ª –±–æ–ª–µ–µ –ø–æ–Ω—è—Ç–Ω—ã–º –∏ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–º.

---

### –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ: E2E —Ç–µ—Å—Ç—ã ‚úÖ

**–î–∞—Ç–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è:** 2025-01-24

**–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ:**
1. ‚úÖ –†–∞—Å—à–∏—Ä–µ–Ω E2E —Ç–µ—Å—Ç `events-integration.spec.ts`:
   - –î–æ–±–∞–≤–ª–µ–Ω–æ 4 –Ω–æ–≤—ã—Ö —Ç–µ—Å—Ç–∞:
     - UI —Ñ–∏–ª—å—Ç—Ä—ã –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ `/admin/events`
     - –î–µ—Ç–∞–ª—å–Ω—ã–π –ø—Ä–æ—Å–º–æ—Ç—Ä —Å–æ–±—ã—Ç–∏—è –≤ –¥–∏–∞–ª–æ–≥–µ
     - –ü—Ä–æ–≤–µ—Ä–∫–∞ –º–∞—Å–∫–∏—Ä–æ–≤–∞–Ω–∏—è PII –¥–∞–Ω–Ω—ã—Ö
     - –≠–∫—Å–ø–æ—Ä—Ç —Å–æ–±—ã—Ç–∏–π –∏–∑ UI

2. ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –ø—Ä–æ–±–ª–µ–º–∞ —Å –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤:
   - –ò—Å–ø—Ä–∞–≤–ª–µ–Ω –ø—É—Ç—å –∫ —Ç–µ—Å—Ç—É –≤ `test-scripts.ts` (—Å `e2e/events-integration.spec.ts` –Ω–∞ `events-integration.spec.ts`)
   - –£–ª—É—á—à–µ–Ω–æ —Å–æ–ø–æ—Å—Ç–∞–≤–ª–µ–Ω–∏–µ `scriptId` –≤ `buildRunSummary`
   - –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ —Å–æ–ø–æ—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –∫–ª—é—á–µ–π –¥–ª—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –≤ UI

**–ò—Ç–æ–≥–æ —Ç–µ—Å—Ç–æ–≤:** 13 E2E —Ç–µ—Å—Ç–æ–≤ –ø–æ–∫—Ä—ã–≤–∞—é—Ç:
- –≠–∫—Å–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö (export.started, export.completed)
- –ò–º–ø–æ—Ä—Ç preview
- –ú–∞—Å—Å–æ–≤—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏
- –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Å–æ–±—ã—Ç–∏–π –∏ correlation
- Actor ID –¥–ª—è –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π
- –≠–∫—Å–ø–æ—Ä—Ç —Å–æ–±—ã—Ç–∏–π –≤ CSV/JSON
- –§–∏–ª—å—Ç—Ä—ã –ø—Ä–∏ —ç–∫—Å–ø–æ—Ä—Ç–µ
- –ü—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞
- UI —Ñ–∏–ª—å—Ç—Ä—ã
- –î–µ—Ç–∞–ª—å–Ω—ã–π –ø—Ä–æ—Å–º–æ—Ç—Ä —Å–æ–±—ã—Ç–∏—è
- –ú–∞—Å–∫–∏—Ä–æ–≤–∞–Ω–∏–µ PII –¥–∞–Ω–Ω—ã—Ö
- –≠–∫—Å–ø–æ—Ä—Ç –∏–∑ UI

---

## üêõ –ü—Ä–æ–±–ª–µ–º—ã –∏ —Ä–µ—à–µ–Ω–∏—è

### –û–±–Ω–∞—Ä—É–∂–µ–Ω–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã:

1. **–û—à–∏–±–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ env –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö**
   - **–û–ø–∏—Å–∞–Ω–∏–µ:** `numberFromEnv` –∏ `booleanFromEnv` –æ–∂–∏–¥–∞–ª–∏ —Å—Ç—Ä–æ–∫–∏, –Ω–æ –ø–æ–ª—É—á–∞–ª–∏ —É–∂–µ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è
   - **–í–ª–∏—è–Ω–∏–µ:** –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –Ω–µ –∑–∞–ø—É—Å–∫–∞–ª–æ—Å—å
   - **–†–µ—à–µ–Ω–∏–µ:** –ò–∑–º–µ–Ω–µ–Ω—ã `.default()` –∑–Ω–∞—á–µ–Ω–∏—è –Ω–∞ —Å—Ç—Ä–æ–∫–∏ (`'90'`, `'true'`) –≤–º–µ—Å—Ç–æ —á–∏—Å–µ–ª/–±—É–ª–µ–≤—ã—Ö
   - **–°—Ç–∞—Ç—É—Å:** ‚úÖ –†–µ—à–µ–Ω–æ

2. **–ù–µ—Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ –ø—É—Ç–∏ –∫ —Ç–µ—Å—Ç—É**
   - **–û–ø–∏—Å–∞–Ω–∏–µ:** –í `test-scripts.ts` –ø—É—Ç—å –±—ã–ª `e2e/events-integration.spec.ts`, –Ω–æ —Ä–µ–∞–ª—å–Ω—ã–π —Ñ–∞–π–ª –≤ `tests/e2e/events-integration.spec.ts`
   - **–í–ª–∏—è–Ω–∏–µ:** –¢–µ—Å—Ç—ã –Ω–µ –ø–æ—è–≤–ª—è–ª–∏—Å—å –≤ Recent Runs, –Ω–µ –æ—Ç–æ–±—Ä–∞–∂–∞–ª–∞—Å—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
   - **–†–µ—à–µ–Ω–∏–µ:** –ò—Å–ø—Ä–∞–≤–ª–µ–Ω –ø—É—Ç—å –Ω–∞ `events-integration.spec.ts` (–æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ testDir)
   - **–°—Ç–∞—Ç—É—Å:** ‚úÖ –†–µ—à–µ–Ω–æ

3. **–ú–∏–≥—Ä–∞—Ü–∏—è –Ω–∞ JSONB –æ—Ç–ª–æ–∂–µ–Ω–∞**
   - **–û–ø–∏—Å–∞–Ω–∏–µ:** –¢–µ–∫—É—â–∞—è –ë–î - SQLite, –∫–æ—Ç–æ—Ä–∞—è –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç JSONB
   - **–í–ª–∏—è–Ω–∏–µ:** –ù–µ–≤–æ–∑–º–æ–∂–Ω–æ –≤—ã–ø–æ–ª–Ω–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏—é
   - **–†–µ—à–µ–Ω–∏–µ:** –≠—Ç–∞–ø –æ—Ç–ª–æ–∂–µ–Ω –¥–æ –ø–µ—Ä–µ—Ö–æ–¥–∞ –Ω–∞ PostgreSQL
   - **–°—Ç–∞—Ç—É—Å:** ‚è∏Ô∏è –û—Ç–ª–æ–∂–µ–Ω–æ

---

## üìä –ú–µ—Ç—Ä–∏–∫–∏

### –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:
- **E2E —Ç–µ—Å—Ç—ã:** 13 —Ç–µ—Å—Ç–æ–≤ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ
- **–ü–æ–∫—Ä—ã—Ç–∏–µ:** –û—Å–Ω–æ–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å –ø–æ–∫—Ä—ã—Ç–∞ —Ç–µ—Å—Ç–∞–º–∏
- **–°—Ç–∞—Ç—É—Å —Ç–µ—Å—Ç–æ–≤:** –ì–æ—Ç–æ–≤—ã –∫ –∑–∞–ø—É—Å–∫—É

### –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª:
- **Retention Policy:** ‚úÖ –ü–æ–ª–Ω–æ—Å—Ç—å—é —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞
- **–≠–∫—Å–ø–æ—Ä—Ç —Å–æ–±—ã—Ç–∏–π:** ‚úÖ –ü–æ–ª–Ω–æ—Å—Ç—å—é —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω (API + UI)
- **–û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫:** ‚úÖ –£–ª—É—á—à–µ–Ω–∞ —Å –º–µ—Ç—Ä–∏–∫–∞–º–∏
- **–£–Ω–∏—Ñ–∏–∫–∞—Ü–∏—è EventService:** ‚úÖ –ó–∞–≤–µ—Ä—à–µ–Ω–∞

### –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å:
- **Retention:** –ë–∞—Ç—á–µ–≤–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ (1000 –∑–∞–ø–∏—Å–µ–π –∑–∞ —Ä–∞–∑)
- **–≠–∫—Å–ø–æ—Ä—Ç:** –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ —Ä–∞–∑–º–µ—Ä–∞ (‚â§10k –∑–∞–ø–∏—Å–µ–π –∏–ª–∏ ‚â§5 MB)
- **–ú–µ—Ç—Ä–∏–∫–∏:** –í—Å–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –æ—Ç—Å–ª–µ–∂–∏–≤–∞—é—Ç—Å—è —á–µ—Ä–µ–∑ Prometheus

---

## üìà –ü—Ä–æ–≥—Ä–µ—Å—Å

- **–ü–ª–∞–Ω–∏—Ä–æ–≤–∞–ª–æ—Å—å:** 4 –æ—Å–Ω–æ–≤–Ω—ã—Ö —ç—Ç–∞–ø–∞
- **–í—ã–ø–æ–ª–Ω–µ–Ω–æ:** 4 –æ—Å–Ω–æ–≤–Ω—ã—Ö —ç—Ç–∞–ø–∞
- **–û—Å—Ç–∞–ª–æ—Å—å:** 0 –æ—Å–Ω–æ–≤–Ω—ã—Ö —ç—Ç–∞–ø–æ–≤
- **–ü—Ä–æ–≥—Ä–µ—Å—Å:** 100% –æ—Å–Ω–æ–≤–Ω—ã—Ö —ç—Ç–∞–ø–æ–≤

**–û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ —ç—Ç–∞–ø—ã:**
- –≠—Ç–∞–ø 5: –ú–∏–≥—Ä–∞—Ü–∏—è –Ω–∞ JSONB - ‚è∏Ô∏è –û—Ç–ª–æ–∂–µ–Ω–æ (—Ç—Ä–µ–±—É–µ—Ç PostgreSQL)
- –≠—Ç–∞–ø 6: –í–∞–ª–∏–¥–∞—Ü–∏—è –Ω–∞ —É—Ä–æ–≤–Ω–µ –ë–î - –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ
- –≠—Ç–∞–ø 7: Live Stream - –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ

---

## üéØ –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

1. [ ] –ú–∏–≥—Ä–∞—Ü–∏—è –Ω–∞ JSONB (–ø–æ—Å–ª–µ –ø–µ—Ä–µ—Ö–æ–¥–∞ –Ω–∞ PostgreSQL)
2. [ ] –í–∞–ª–∏–¥–∞—Ü–∏—è –Ω–∞ —É—Ä–æ–≤–Ω–µ –ë–î (CHECK constraints)
3. [ ] Live Stream (SSE –∏–ª–∏ Socket.IO)
4. [ ] –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ E2E —Ç–µ—Å—Ç—ã –¥–ª—è –¥—Ä—É–≥–∏—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤ —Å–æ–±—ã—Ç–∏–π

---

## üí° –í—ã–≤–æ–¥—ã –∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

### –ß—Ç–æ —Å–¥–µ–ª–∞–Ω–æ —Ö–æ—Ä–æ—à–æ:
1. ‚úÖ –í—Å–µ –æ—Å–Ω–æ–≤–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è –∏–∑ –¢–ó –≤—ã–ø–æ–ª–Ω–µ–Ω—ã
2. ‚úÖ Retention Policy –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç –Ω–µ–æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω—ã–π —Ä–æ—Å—Ç –ë–î
3. ‚úÖ –≠–∫—Å–ø–æ—Ä—Ç —Å–æ–±—ã—Ç–∏–π –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–µ–Ω (API + UI)
4. ‚úÖ –£–ª—É—á—à–µ–Ω–∞ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ —á–µ—Ä–µ–∑ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –º–µ—Ç—Ä–∏–∫–∏
5. ‚úÖ –£—Å—Ç—Ä–∞–Ω–µ–Ω—ã –∫–æ–Ω—Ñ–ª–∏–∫—Ç—ã –∏–º–µ–Ω –≤ –∫–æ–¥–µ

### –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:
1. **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥:** –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –∞–ª–µ—Ä—Ç—ã –Ω–∞ –º–µ—Ç—Ä–∏–∫–∏ –æ—à–∏–±–æ–∫ –ø–∞—Ä—Å–∏–Ω–≥–∞
2. **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å:** –ü—Ä–∏ —Ä–æ—Å—Ç–µ –æ–±—ä–µ–º–∞ –¥–∞–Ω–Ω—ã—Ö —Ä–∞—Å—Å–º–æ—Ç—Ä–µ—Ç—å –∏–Ω–¥–µ–∫—Å—ã –Ω–∞ —á–∞—Å—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –ø–æ–ª—è
3. **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å:** –†–µ–≥—É–ª—è—Ä–Ω–æ –ø—Ä–æ–≤–µ—Ä—è—Ç—å —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –º–∞—Å–∫–∏—Ä–æ–≤–∞–Ω–∏—è PII –¥–∞–Ω–Ω—ã—Ö
4. **–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è:** –û–±–Ω–æ–≤–∏—Ç—å README —Å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π –æ –Ω–æ–≤—ã—Ö –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—è—Ö

### –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π –¥–æ–ª–≥:
- –ú–∏–≥—Ä–∞—Ü–∏—è –Ω–∞ JSONB –æ—Ç–ª–æ–∂–µ–Ω–∞ –¥–æ –ø–µ—Ä–µ—Ö–æ–¥–∞ –Ω–∞ PostgreSQL
- Live Stream –Ω–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω (–Ω–∏–∑–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç)

---

## üìù –ü—Ä–∏–º–µ—á–∞–Ω–∏—è

- –í—Å–µ –æ—Å–Ω–æ–≤–Ω—ã–µ —ç—Ç–∞–ø—ã –∑–∞–≤–µ—Ä—à–µ–Ω—ã –≤ —Å—Ä–æ–∫
- E2E —Ç–µ—Å—Ç—ã —Ä–∞—Å—à–∏—Ä–µ–Ω—ã –∏ –ø–æ–∫—Ä—ã–≤–∞—é—Ç UI —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å
- –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∞
- –°—Ç–∞—Ä—ã–µ —Ñ–∞–π–ª—ã –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ —É–¥–∞–ª–µ–Ω—ã (–¥—É–±–ª–∏–∫–∞—Ç—ã)

---

**–ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ:** 2025-01-24  
**–ê–≤—Ç–æ—Ä:** AI Assistant







