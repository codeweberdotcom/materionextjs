{
  "id": null,
  "uid": "materio-operations",
  "title": "Materio Application Operations",
  "description": "Application operations: API errors, bulk ops, events, import/export, roles, translations",
  "timezone": "browser",
  "schemaVersion": 39,
  "version": 1,
  "refresh": "10s",
  "tags": ["operations", "api", "events", "admin"],
  "templating": {
    "list": [
      {
        "name": "environment",
        "type": "custom",
        "current": {
          "selected": true,
          "text": "All",
          "value": "$__all"
        },
        "options": [
          { "selected": true, "text": "All", "value": "$__all" },
          { "selected": false, "text": "development", "value": "development" },
          { "selected": false, "text": "production", "value": "production" }
        ],
        "includeAll": true,
        "multi": false
      }
    ]
  },
  "panels": [
    {
      "type": "row",
      "title": "üö® API Errors",
      "gridPos": { "x": 0, "y": 0, "w": 24, "h": 1 },
      "collapsed": false
    },
    {
      "type": "stat",
      "title": "API Errors (5m)",
      "description": "Total API errors in last 5 minutes",
      "gridPos": { "x": 0, "y": 1, "w": 6, "h": 4 },
      "fieldConfig": {
        "defaults": {
          "color": { "mode": "thresholds" },
          "thresholds": {
            "mode": "absolute",
            "steps": [
              { "color": "green", "value": null },
              { "color": "yellow", "value": 10 },
              { "color": "red", "value": 50 }
            ]
          },
          "unit": "short"
        }
      },
      "options": {
        "colorMode": "value",
        "graphMode": "area",
        "justifyMode": "auto",
        "reduceOptions": { "calcs": ["lastNotNull"], "fields": "", "values": false }
      },
      "targets": [
        {
          "expr": "sum(increase(api_errors_total{environment=~\"$environment\"}[5m]))",
          "legendFormat": "Errors",
          "refId": "A"
        }
      ]
    },
    {
      "type": "timeseries",
      "title": "API Errors by Route",
      "description": "API errors over time by route",
      "gridPos": { "x": 6, "y": 1, "w": 9, "h": 8 },
      "fieldConfig": {
        "defaults": {
          "color": { "mode": "palette-classic" },
          "unit": "short"
        }
      },
      "options": {
        "legend": { "displayMode": "list", "placement": "bottom" },
        "tooltip": { "mode": "multi" }
      },
      "targets": [
        {
          "expr": "sum(rate(api_errors_total{environment=~\"$environment\"}[5m])) by (route) * 60",
          "legendFormat": "{{route}}",
          "refId": "A"
        }
      ]
    },
    {
      "type": "piechart",
      "title": "Errors by Status",
      "description": "Distribution of errors by HTTP status",
      "gridPos": { "x": 15, "y": 1, "w": 9, "h": 8 },
      "fieldConfig": {
        "defaults": {
          "color": { "mode": "palette-classic" }
        }
      },
      "options": {
        "legend": { "displayMode": "table", "placement": "right", "values": ["value", "percent"] },
        "pieType": "pie",
        "tooltip": { "mode": "single" }
      },
      "targets": [
        {
          "expr": "sum(increase(api_errors_total{environment=~\"$environment\"}[1h])) by (status)",
          "legendFormat": "{{status}}",
          "refId": "A"
        }
      ]
    },
    {
      "type": "row",
      "title": "üì¶ Bulk Operations",
      "gridPos": { "x": 0, "y": 9, "w": 24, "h": 1 },
      "collapsed": false
    },
    {
      "type": "stat",
      "title": "Bulk Success (5m)",
      "description": "Successful bulk operations",
      "gridPos": { "x": 0, "y": 10, "w": 4, "h": 4 },
      "fieldConfig": {
        "defaults": {
          "color": { "mode": "thresholds" },
          "thresholds": {
            "mode": "absolute",
            "steps": [
              { "color": "green", "value": null }
            ]
          },
          "unit": "short"
        }
      },
      "options": {
        "colorMode": "value",
        "graphMode": "area",
        "justifyMode": "auto",
        "reduceOptions": { "calcs": ["lastNotNull"], "fields": "", "values": false }
      },
      "targets": [
        {
          "expr": "sum(increase(bulk_operations_success_total{environment=~\"$environment\"}[5m]))",
          "legendFormat": "Success",
          "refId": "A"
        }
      ]
    },
    {
      "type": "stat",
      "title": "Bulk Failed (5m)",
      "description": "Failed bulk operations",
      "gridPos": { "x": 4, "y": 10, "w": 4, "h": 4 },
      "fieldConfig": {
        "defaults": {
          "color": { "mode": "thresholds" },
          "thresholds": {
            "mode": "absolute",
            "steps": [
              { "color": "green", "value": null },
              { "color": "yellow", "value": 1 },
              { "color": "red", "value": 5 }
            ]
          },
          "unit": "short"
        }
      },
      "options": {
        "colorMode": "value",
        "graphMode": "area",
        "justifyMode": "auto",
        "reduceOptions": { "calcs": ["lastNotNull"], "fields": "", "values": false }
      },
      "targets": [
        {
          "expr": "sum(increase(bulk_operations_failure_total{environment=~\"$environment\"}[5m]))",
          "legendFormat": "Failed",
          "refId": "A"
        }
      ]
    },
    {
      "type": "timeseries",
      "title": "Bulk Operations by Type",
      "description": "Bulk operations over time",
      "gridPos": { "x": 8, "y": 10, "w": 8, "h": 8 },
      "fieldConfig": {
        "defaults": {
          "color": { "mode": "palette-classic" },
          "unit": "short"
        }
      },
      "options": {
        "legend": { "displayMode": "list", "placement": "bottom" },
        "tooltip": { "mode": "multi" }
      },
      "targets": [
        {
          "expr": "sum(rate(bulk_operations_success_total{environment=~\"$environment\"}[5m])) by (operation) * 60",
          "legendFormat": "{{operation}} (success)",
          "refId": "A"
        },
        {
          "expr": "sum(rate(bulk_operations_failure_total{environment=~\"$environment\"}[5m])) by (operation) * 60",
          "legendFormat": "{{operation}} (failed)",
          "refId": "B"
        }
      ]
    },
    {
      "type": "timeseries",
      "title": "Bulk Duration (p95)",
      "description": "Bulk operation duration percentiles",
      "gridPos": { "x": 16, "y": 10, "w": 8, "h": 8 },
      "fieldConfig": {
        "defaults": {
          "color": { "mode": "palette-classic" },
          "unit": "s"
        }
      },
      "options": {
        "legend": { "displayMode": "list", "placement": "bottom" },
        "tooltip": { "mode": "multi" }
      },
      "targets": [
        {
          "expr": "histogram_quantile(0.95, sum(rate(bulk_operations_duration_seconds_bucket{environment=~\"$environment\"}[5m])) by (le, operation))",
          "legendFormat": "{{operation}} p95",
          "refId": "A"
        }
      ]
    },
    {
      "type": "row",
      "title": "üìã Events (EventService)",
      "gridPos": { "x": 0, "y": 18, "w": 24, "h": 1 },
      "collapsed": false
    },
    {
      "type": "stat",
      "title": "Events Recorded (5m)",
      "description": "Events recorded via EventService",
      "gridPos": { "x": 0, "y": 19, "w": 4, "h": 4 },
      "fieldConfig": {
        "defaults": {
          "color": { "mode": "thresholds" },
          "thresholds": {
            "mode": "absolute",
            "steps": [
              { "color": "blue", "value": null }
            ]
          },
          "unit": "short"
        }
      },
      "options": {
        "colorMode": "value",
        "graphMode": "area",
        "justifyMode": "auto",
        "reduceOptions": { "calcs": ["lastNotNull"], "fields": "", "values": false }
      },
      "targets": [
        {
          "expr": "sum(increase(events_recorded_total{environment=~\"$environment\"}[5m]))",
          "legendFormat": "Recorded",
          "refId": "A"
        }
      ]
    },
    {
      "type": "stat",
      "title": "Events Failed (5m)",
      "description": "Failed event writes",
      "gridPos": { "x": 4, "y": 19, "w": 4, "h": 4 },
      "fieldConfig": {
        "defaults": {
          "color": { "mode": "thresholds" },
          "thresholds": {
            "mode": "absolute",
            "steps": [
              { "color": "green", "value": null },
              { "color": "yellow", "value": 1 },
              { "color": "red", "value": 5 }
            ]
          },
          "unit": "short"
        }
      },
      "options": {
        "colorMode": "value",
        "graphMode": "area",
        "justifyMode": "auto",
        "reduceOptions": { "calcs": ["lastNotNull"], "fields": "", "values": false }
      },
      "targets": [
        {
          "expr": "sum(increase(events_record_failures_total{environment=~\"$environment\"}[5m]))",
          "legendFormat": "Failed",
          "refId": "A"
        }
      ]
    },
    {
      "type": "timeseries",
      "title": "Events by Type",
      "description": "Events over time by type",
      "gridPos": { "x": 8, "y": 19, "w": 8, "h": 8 },
      "fieldConfig": {
        "defaults": {
          "color": { "mode": "palette-classic" },
          "unit": "short"
        }
      },
      "options": {
        "legend": { "displayMode": "list", "placement": "bottom" },
        "tooltip": { "mode": "multi" }
      },
      "targets": [
        {
          "expr": "sum(rate(events_recorded_total{environment=~\"$environment\"}[5m])) by (type) * 60",
          "legendFormat": "{{type}}",
          "refId": "A"
        }
      ]
    },
    {
      "type": "timeseries",
      "title": "Event Recording Duration",
      "description": "Time spent recording events",
      "gridPos": { "x": 16, "y": 19, "w": 8, "h": 8 },
      "fieldConfig": {
        "defaults": {
          "color": { "mode": "palette-classic" },
          "unit": "s"
        }
      },
      "options": {
        "legend": { "displayMode": "list", "placement": "bottom" },
        "tooltip": { "mode": "multi" }
      },
      "targets": [
        {
          "expr": "histogram_quantile(0.95, sum(rate(events_record_duration_seconds_bucket{environment=~\"$environment\"}[5m])) by (le))",
          "legendFormat": "p95",
          "refId": "A"
        }
      ]
    },
    {
      "type": "row",
      "title": "üì§ Import / Export",
      "gridPos": { "x": 0, "y": 27, "w": 24, "h": 1 },
      "collapsed": false
    },
    {
      "type": "stat",
      "title": "Exports (5m)",
      "description": "Export operations",
      "gridPos": { "x": 0, "y": 28, "w": 4, "h": 4 },
      "fieldConfig": {
        "defaults": {
          "color": { "mode": "thresholds" },
          "thresholds": {
            "mode": "absolute",
            "steps": [
              { "color": "blue", "value": null }
            ]
          },
          "unit": "short"
        }
      },
      "options": {
        "colorMode": "value",
        "graphMode": "area",
        "justifyMode": "auto",
        "reduceOptions": { "calcs": ["lastNotNull"], "fields": "", "values": false }
      },
      "targets": [
        {
          "expr": "sum(increase(export_operations_total{environment=~\"$environment\"}[5m]))",
          "legendFormat": "Exports",
          "refId": "A"
        }
      ]
    },
    {
      "type": "stat",
      "title": "Imports (5m)",
      "description": "Import operations",
      "gridPos": { "x": 4, "y": 28, "w": 4, "h": 4 },
      "fieldConfig": {
        "defaults": {
          "color": { "mode": "thresholds" },
          "thresholds": {
            "mode": "absolute",
            "steps": [
              { "color": "purple", "value": null }
            ]
          },
          "unit": "short"
        }
      },
      "options": {
        "colorMode": "value",
        "graphMode": "area",
        "justifyMode": "auto",
        "reduceOptions": { "calcs": ["lastNotNull"], "fields": "", "values": false }
      },
      "targets": [
        {
          "expr": "sum(increase(import_operations_total{environment=~\"$environment\"}[5m]))",
          "legendFormat": "Imports",
          "refId": "A"
        }
      ]
    },
    {
      "type": "timeseries",
      "title": "Import/Export Operations",
      "description": "Operations over time",
      "gridPos": { "x": 8, "y": 28, "w": 8, "h": 8 },
      "fieldConfig": {
        "defaults": {
          "color": { "mode": "palette-classic" },
          "unit": "short"
        }
      },
      "options": {
        "legend": { "displayMode": "list", "placement": "bottom" },
        "tooltip": { "mode": "multi" }
      },
      "targets": [
        {
          "expr": "sum(rate(export_operations_total{environment=~\"$environment\"}[5m])) by (entity) * 60",
          "legendFormat": "export {{entity}}",
          "refId": "A"
        },
        {
          "expr": "sum(rate(import_operations_total{environment=~\"$environment\"}[5m])) by (entity) * 60",
          "legendFormat": "import {{entity}}",
          "refId": "B"
        }
      ]
    },
    {
      "type": "timeseries",
      "title": "Import/Export Duration",
      "description": "Operation duration",
      "gridPos": { "x": 16, "y": 28, "w": 8, "h": 8 },
      "fieldConfig": {
        "defaults": {
          "color": { "mode": "palette-classic" },
          "unit": "s"
        }
      },
      "options": {
        "legend": { "displayMode": "list", "placement": "bottom" },
        "tooltip": { "mode": "multi" }
      },
      "targets": [
        {
          "expr": "histogram_quantile(0.95, sum(rate(export_duration_seconds_bucket{environment=~\"$environment\"}[5m])) by (le))",
          "legendFormat": "export p95",
          "refId": "A"
        },
        {
          "expr": "histogram_quantile(0.95, sum(rate(import_duration_seconds_bucket{environment=~\"$environment\"}[5m])) by (le))",
          "legendFormat": "import p95",
          "refId": "B"
        }
      ]
    },
    {
      "type": "row",
      "title": "üîê Roles",
      "gridPos": { "x": 0, "y": 36, "w": 24, "h": 1 },
      "collapsed": false
    },
    {
      "type": "stat",
      "title": "Role Operations (5m)",
      "description": "Role CRUD operations",
      "gridPos": { "x": 0, "y": 37, "w": 4, "h": 4 },
      "fieldConfig": {
        "defaults": {
          "color": { "mode": "thresholds" },
          "thresholds": {
            "mode": "absolute",
            "steps": [
              { "color": "blue", "value": null }
            ]
          },
          "unit": "short"
        }
      },
      "options": {
        "colorMode": "value",
        "graphMode": "area",
        "justifyMode": "auto",
        "reduceOptions": { "calcs": ["lastNotNull"], "fields": "", "values": false }
      },
      "targets": [
        {
          "expr": "sum(increase(role_operations_total{environment=~\"$environment\"}[5m]))",
          "legendFormat": "Operations",
          "refId": "A"
        }
      ]
    },
    {
      "type": "stat",
      "title": "Cache Errors (5m)",
      "description": "Role cache errors",
      "gridPos": { "x": 4, "y": 37, "w": 4, "h": 4 },
      "fieldConfig": {
        "defaults": {
          "color": { "mode": "thresholds" },
          "thresholds": {
            "mode": "absolute",
            "steps": [
              { "color": "green", "value": null },
              { "color": "yellow", "value": 1 },
              { "color": "red", "value": 5 }
            ]
          },
          "unit": "short"
        }
      },
      "options": {
        "colorMode": "value",
        "graphMode": "area",
        "justifyMode": "auto",
        "reduceOptions": { "calcs": ["lastNotNull"], "fields": "", "values": false }
      },
      "targets": [
        {
          "expr": "sum(increase(role_cache_errors_total{environment=~\"$environment\"}[5m]))",
          "legendFormat": "Errors",
          "refId": "A"
        }
      ]
    },
    {
      "type": "timeseries",
      "title": "Role Operations by Type",
      "description": "CRUD operations over time",
      "gridPos": { "x": 8, "y": 37, "w": 8, "h": 8 },
      "fieldConfig": {
        "defaults": {
          "color": { "mode": "palette-classic" },
          "unit": "short"
        }
      },
      "options": {
        "legend": { "displayMode": "list", "placement": "bottom" },
        "tooltip": { "mode": "multi" }
      },
      "targets": [
        {
          "expr": "sum(rate(role_operations_total{environment=~\"$environment\"}[5m])) by (operation) * 60",
          "legendFormat": "{{operation}}",
          "refId": "A"
        }
      ]
    },
    {
      "type": "timeseries",
      "title": "Role Cache Switches",
      "description": "Cache store switches (Redis ‚Üî In-memory)",
      "gridPos": { "x": 16, "y": 37, "w": 8, "h": 8 },
      "fieldConfig": {
        "defaults": {
          "color": { "mode": "palette-classic" },
          "unit": "short"
        }
      },
      "options": {
        "legend": { "displayMode": "list", "placement": "bottom" },
        "tooltip": { "mode": "multi" }
      },
      "targets": [
        {
          "expr": "sum(rate(role_cache_switches_total{environment=~\"$environment\"}[5m])) by (from, to) * 60",
          "legendFormat": "{{from}} ‚Üí {{to}}",
          "refId": "A"
        }
      ]
    },
    {
      "type": "row",
      "title": "üåê Translations",
      "gridPos": { "x": 0, "y": 45, "w": 24, "h": 1 },
      "collapsed": false
    },
    {
      "type": "stat",
      "title": "Translation Ops (5m)",
      "description": "Translation operations",
      "gridPos": { "x": 0, "y": 46, "w": 4, "h": 4 },
      "fieldConfig": {
        "defaults": {
          "color": { "mode": "thresholds" },
          "thresholds": {
            "mode": "absolute",
            "steps": [
              { "color": "blue", "value": null }
            ]
          },
          "unit": "short"
        }
      },
      "options": {
        "colorMode": "value",
        "graphMode": "area",
        "justifyMode": "auto",
        "reduceOptions": { "calcs": ["lastNotNull"], "fields": "", "values": false }
      },
      "targets": [
        {
          "expr": "sum(increase(translation_operations_total{environment=~\"$environment\"}[5m]))",
          "legendFormat": "Operations",
          "refId": "A"
        }
      ]
    },
    {
      "type": "stat",
      "title": "Translation Import (5m)",
      "description": "Translation imports",
      "gridPos": { "x": 4, "y": 46, "w": 4, "h": 4 },
      "fieldConfig": {
        "defaults": {
          "color": { "mode": "thresholds" },
          "thresholds": {
            "mode": "absolute",
            "steps": [
              { "color": "purple", "value": null }
            ]
          },
          "unit": "short"
        }
      },
      "options": {
        "colorMode": "value",
        "graphMode": "area",
        "justifyMode": "auto",
        "reduceOptions": { "calcs": ["lastNotNull"], "fields": "", "values": false }
      },
      "targets": [
        {
          "expr": "sum(increase(translation_import_total{environment=~\"$environment\"}[5m]))",
          "legendFormat": "Imports",
          "refId": "A"
        }
      ]
    },
    {
      "type": "timeseries",
      "title": "Translation Operations",
      "description": "Operations over time",
      "gridPos": { "x": 8, "y": 46, "w": 8, "h": 8 },
      "fieldConfig": {
        "defaults": {
          "color": { "mode": "palette-classic" },
          "unit": "short"
        }
      },
      "options": {
        "legend": { "displayMode": "list", "placement": "bottom" },
        "tooltip": { "mode": "multi" }
      },
      "targets": [
        {
          "expr": "sum(rate(translation_operations_total{environment=~\"$environment\"}[5m])) by (operation) * 60",
          "legendFormat": "{{operation}}",
          "refId": "A"
        }
      ]
    },
    {
      "type": "timeseries",
      "title": "Translation Duration",
      "description": "Operation duration",
      "gridPos": { "x": 16, "y": 46, "w": 8, "h": 8 },
      "fieldConfig": {
        "defaults": {
          "color": { "mode": "palette-classic" },
          "unit": "s"
        }
      },
      "options": {
        "legend": { "displayMode": "list", "placement": "bottom" },
        "tooltip": { "mode": "multi" }
      },
      "targets": [
        {
          "expr": "histogram_quantile(0.95, sum(rate(translation_operation_duration_seconds_bucket{environment=~\"$environment\"}[5m])) by (le))",
          "legendFormat": "p95",
          "refId": "A"
        }
      ]
    }
  ]
}

